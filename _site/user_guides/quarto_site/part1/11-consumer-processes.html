<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Atlantis Documentation – 10. CONSUMER PROCESSES</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Atlantis Documentation</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-user-guides" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">User Guides</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-user-guides">    
        <li>
    <a class="dropdown-item" href="../../../user_guides/quarto_site/part1/index.html">
 <span class="dropdown-text">Part I - Atlantis User Guide</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../user_guides/quarto_site/part2/index.qmd">
 <span class="dropdown-text">Part II - [Coming Soon]</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../confluence/index.html"> 
<span class="menu-text">Confluence Wiki</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../resources/index.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../user_guides/quarto_site/part1/11-consumer-processes.html">10. Consumer Processes</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_guides/quarto_site/part1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_guides/quarto_site/part1/01-foreward.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">0. Foreword</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_guides/quarto_site/part1/02-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_guides/quarto_site/part1/03-installation-and-running.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Installation and Running</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_guides/quarto_site/part1/04-geometry-of-the-model-domain.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Geometry of the Model Domain</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_guides/quarto_site/part1/05-hydrodynamic-salinity-and-temperat.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Hydrodynamic, Salinity and Temperature Forcing Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_guides/quarto_site/part1/06-the-physics-submodel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. The Physics Submodel</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_guides/quarto_site/part1/07-definitions-of-functional-groups.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Definitions of Functional Groups</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_guides/quarto_site/part1/08-run-parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. Run Parameters</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_guides/quarto_site/part1/09-force-parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8. Force Parameters</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_guides/quarto_site/part1/10-primary-producer-processes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Primary Producer Processes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_guides/quarto_site/part1/11-consumer-processes.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">10. Consumer Processes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_guides/quarto_site/part1/12-distribution-and-movement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11. Distribution and Movement</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_guides/quarto_site/part1/13-processes-in-bacterial-and-inanimate.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12. Processes in Bacterial and Inanimate Pools</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_guides/quarto_site/part1/14-influence-of-environmental-factors-o.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13. Influence of Environmental Factors on Ecological Processes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_guides/quarto_site/part1/15-final-overview-of-ecology-routines.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14. Final Overview of Ecology Routines</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_guides/quarto_site/part1/16-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../user_guides/quarto_site/part1/17-appendix-1-tips-for-calibrating-biolo.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix 1: Tips for Calibrating Biological Model</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#fluxes-in-consumer-biomass-pools" id="toc-fluxes-in-consumer-biomass-pools" class="nav-link active" data-scroll-target="#fluxes-in-consumer-biomass-pools"><strong>10.1. Fluxes in consumer biomass pools</strong></a></li>
  <li><a href="#consumer-feeding" id="toc-consumer-feeding" class="nav-link" data-scroll-target="#consumer-feeding"><strong>10.2. Consumer feeding</strong></a>
  <ul>
  <li><a href="#grazing" id="toc-grazing" class="nav-link" data-scroll-target="#grazing"><em>10.2.1 Grazing</em></a></li>
  <li><a href="#what-are-the-c-and-mum-parameters" id="toc-what-are-the-c-and-mum-parameters" class="nav-link" data-scroll-target="#what-are-the-c-and-mum-parameters"><em>10.2.2 What are the</em> C <em>and</em> mum <em>parameters?</em></a></li>
  <li><a href="#what-determines-prey-biomass-available-for-predation" id="toc-what-determines-prey-biomass-available-for-predation" class="nav-link" data-scroll-target="#what-determines-prey-biomass-available-for-predation"><strong><em>10.2.3. What determines prey biomass available for predation?</em></strong></a></li>
  <li><a href="#habitat-refuge" id="toc-habitat-refuge" class="nav-link" data-scroll-target="#habitat-refuge"><strong><em>10.2.4. Habitat refuge</em></strong></a></li>
  <li><a href="#size-refuge-from-predation" id="toc-size-refuge-from-predation" class="nav-link" data-scroll-target="#size-refuge-from-predation"><strong><em>10.2.5. Size refuge from predation</em></strong></a></li>
  <li><a href="#availability-of-fisheries-catches-to-opportunistic-catch-eaters" id="toc-availability-of-fisheries-catches-to-opportunistic-catch-eaters" class="nav-link" data-scroll-target="#availability-of-fisheries-catches-to-opportunistic-catch-eaters"><strong><em>10.2.6. Availability of fisheries catches to opportunistic catch-eaters</em></strong></a></li>
  <li><a href="#effect-of-temperature-and-salinity-on-feeding-parameters" id="toc-effect-of-temperature-and-salinity-on-feeding-parameters" class="nav-link" data-scroll-target="#effect-of-temperature-and-salinity-on-feeding-parameters"><em>10.2.7. Effect of temperature and salinity on feeding parameters</em></a></li>
  <li><a href="#effect-of-oxygen-limitation-on-epibenthic-invertebrate-feeding-rates" id="toc-effect-of-oxygen-limitation-on-epibenthic-invertebrate-feeding-rates" class="nav-link" data-scroll-target="#effect-of-oxygen-limitation-on-epibenthic-invertebrate-feeding-rates"><em>10.2.8. Effect of oxygen limitation on epibenthic invertebrate feeding rates</em></a></li>
  <li><a href="#effect-of-space-limitation-on-epibenthic-invertebrate-feeding-rates" id="toc-effect-of-space-limitation-on-epibenthic-invertebrate-feeding-rates" class="nav-link" data-scroll-target="#effect-of-space-limitation-on-epibenthic-invertebrate-feeding-rates"><em>10.2.9. Effect of space limitation on epibenthic invertebrate feeding rates</em></a></li>
  <li><a href="#other-factors-affecting-feeding-parameters" id="toc-other-factors-affecting-feeding-parameters" class="nav-link" data-scroll-target="#other-factors-affecting-feeding-parameters"><em>10.2.10. Other factors affecting feeding parameters</em></a></li>
  <li><a href="#other-feeding-functional-responses" id="toc-other-feeding-functional-responses" class="nav-link" data-scroll-target="#other-feeding-functional-responses"><em>10.2.11 Other feeding functional responses</em></a></li>
  </ul></li>
  <li><a href="#food-assimilation-in-consumers" id="toc-food-assimilation-in-consumers" class="nav-link" data-scroll-target="#food-assimilation-in-consumers"><strong>10.3. Food assimilation in consumers</strong></a></li>
  <li><a href="#maintenance-respiration-in-consumers" id="toc-maintenance-respiration-in-consumers" class="nav-link" data-scroll-target="#maintenance-respiration-in-consumers"><strong>10.4. Maintenance (respiration) in consumers</strong></a>
  <ul>
  <li><a href="#scaling-of-respiration-costs-depending-on-individuals-condition" id="toc-scaling-of-respiration-costs-depending-on-individuals-condition" class="nav-link" data-scroll-target="#scaling-of-respiration-costs-depending-on-individuals-condition"><strong><em>10.4.1 Scaling of respiration costs depending on individual’s condition</em></strong></a></li>
  </ul></li>
  <li><a href="#growth" id="toc-growth" class="nav-link" data-scroll-target="#growth"><strong>10.5. Growth</strong></a>
  <ul>
  <li><a href="#growth-and-energy-allocation-in-age-structured-groups" id="toc-growth-and-energy-allocation-in-age-structured-groups" class="nav-link" data-scroll-target="#growth-and-energy-allocation-in-age-structured-groups"><strong><em>10.5.1. Growth and energy allocation in age-structured groups</em></strong></a></li>
  <li><a href="#when-is-an-age-structured-group-starving-and-what-does-it-mean" id="toc-when-is-an-age-structured-group-starving-and-what-does-it-mean" class="nav-link" data-scroll-target="#when-is-an-age-structured-group-starving-and-what-does-it-mean"><em>10.5.2. When is an age-structured group starving and what does it mean?</em></a></li>
  <li><a href="#growth-in-consumer-biomass-pools" id="toc-growth-in-consumer-biomass-pools" class="nav-link" data-scroll-target="#growth-in-consumer-biomass-pools"><strong><em>10.5.3 Growth in consumer biomass pools</em></strong></a></li>
  <li><a href="#feeding-on-material-outside-the-model" id="toc-feeding-on-material-outside-the-model" class="nav-link" data-scroll-target="#feeding-on-material-outside-the-model"><strong><em>10.5.4 Feeding on material outside the model</em></strong></a></li>
  <li><a href="#effect-of-contaminants-on-the-growth-model" id="toc-effect-of-contaminants-on-the-growth-model" class="nav-link" data-scroll-target="#effect-of-contaminants-on-the-growth-model"><strong><em>10.5.5 Effect of contaminants on the growth model</em></strong></a></li>
  </ul></li>
  <li><a href="#mortality-in-consumers" id="toc-mortality-in-consumers" class="nav-link" data-scroll-target="#mortality-in-consumers"><strong>10.6. Mortality in consumers</strong></a>
  <ul>
  <li><a href="#mortality-in-age-structured-groups" id="toc-mortality-in-age-structured-groups" class="nav-link" data-scroll-target="#mortality-in-age-structured-groups"><strong><em>10.6.1. Mortality in age-structured groups</em></strong></a></li>
  <li><a href="#starvation-mortality-in-age-structured-groups" id="toc-starvation-mortality-in-age-structured-groups" class="nav-link" data-scroll-target="#starvation-mortality-in-age-structured-groups"><strong><em>10.6.2. Starvation mortality in age-structured groups</em></strong></a></li>
  <li><a href="#extra-mortality-in-age-structured-groups" id="toc-extra-mortality-in-age-structured-groups" class="nav-link" data-scroll-target="#extra-mortality-in-age-structured-groups"><strong><em>10.6.3. Extra mortality in age-structured groups</em></strong></a></li>
  <li><a href="#mortality-in-biomass-pool-consumers" id="toc-mortality-in-biomass-pool-consumers" class="nav-link" data-scroll-target="#mortality-in-biomass-pool-consumers"><strong><em>10.6.4. Mortality in biomass pool consumers</em></strong></a></li>
  <li><a href="#temperature-and-acidification-effect-on-mortality" id="toc-temperature-and-acidification-effect-on-mortality" class="nav-link" data-scroll-target="#temperature-and-acidification-effect-on-mortality"><strong><em>10.6.5. Temperature and acidification effect on mortality</em></strong></a></li>
  <li><a href="#turbidity-effect-on-mortality" id="toc-turbidity-effect-on-mortality" class="nav-link" data-scroll-target="#turbidity-effect-on-mortality"><strong><em>10.6.6. Turbidity effect on mortality</em></strong></a></li>
  </ul></li>
  <li><a href="#waste-production" id="toc-waste-production" class="nav-link" data-scroll-target="#waste-production"><strong>10.7. Waste production</strong></a></li>
  <li><a href="#spawn" id="toc-spawn" class="nav-link" data-scroll-target="#spawn"><strong>10.8. Spawn</strong></a>
  <ul>
  <li><a href="#sexual-maturation-in-age-structured-groups" id="toc-sexual-maturation-in-age-structured-groups" class="nav-link" data-scroll-target="#sexual-maturation-in-age-structured-groups"><em>10.8.1. Sexual maturation in age-structured groups</em></a></li>
  <li><a href="#spawning-in-age-structured-groups" id="toc-spawning-in-age-structured-groups" class="nav-link" data-scroll-target="#spawning-in-age-structured-groups"><strong><em>10.8.2. Spawning in age-structured groups</em></strong></a></li>
  <li><a href="#maturation-and-spawn-in-age-structured-biomass-pools" id="toc-maturation-and-spawn-in-age-structured-biomass-pools" class="nav-link" data-scroll-target="#maturation-and-spawn-in-age-structured-biomass-pools"><strong><em>10.8.3. Maturation and spawn in age-structured biomass pools</em></strong></a></li>
  </ul></li>
  <li><a href="#recruitment-and-ageing" id="toc-recruitment-and-ageing" class="nav-link" data-scroll-target="#recruitment-and-ageing"><strong>10.9. Recruitment and ageing</strong></a>
  <ul>
  <li><a href="#routines-used-to-calculate-recruitment-in-age-structured-groups" id="toc-routines-used-to-calculate-recruitment-in-age-structured-groups" class="nav-link" data-scroll-target="#routines-used-to-calculate-recruitment-in-age-structured-groups"><strong><em>10.9.1 Routines used to calculate recruitment in age-structured groups</em></strong></a></li>
  <li><a href="#stock-recruitment-options" id="toc-stock-recruitment-options" class="nav-link" data-scroll-target="#stock-recruitment-options"><strong><em>10.9.2. Stock-recruitment options</em></strong></a></li>
  <li><a href="#environmental-habitat-and-external-recruitment-scalars" id="toc-environmental-habitat-and-external-recruitment-scalars" class="nav-link" data-scroll-target="#environmental-habitat-and-external-recruitment-scalars"><strong><em>10.9.3. Environmental, habitat and external recruitment scalars</em></strong></a></li>
  <li><a href="#spatial-distribution-of-recruits" id="toc-spatial-distribution-of-recruits" class="nav-link" data-scroll-target="#spatial-distribution-of-recruits"><strong><em>10.9.4. Spatial distribution of recruits</em></strong></a></li>
  <li><a href="#factors-defining-temporal-arrival-of-recruits" id="toc-factors-defining-temporal-arrival-of-recruits" class="nav-link" data-scroll-target="#factors-defining-temporal-arrival-of-recruits"><strong><em>10.9.5. Factors defining temporal arrival of recruits</em></strong></a></li>
  <li><a href="#modifying-size-at-recruitment" id="toc-modifying-size-at-recruitment" class="nav-link" data-scroll-target="#modifying-size-at-recruitment"><strong><em>10.9.6. Modifying size at recruitment</em></strong></a></li>
  <li><a href="#stochastic-variation-around-mean-recruitment" id="toc-stochastic-variation-around-mean-recruitment" class="nav-link" data-scroll-target="#stochastic-variation-around-mean-recruitment"><strong><em>10.9.7. Stochastic variation around mean recruitment</em></strong></a></li>
  <li><a href="#ageing-of-individuals" id="toc-ageing-of-individuals" class="nav-link" data-scroll-target="#ageing-of-individuals"><strong><em>10.9.8. Ageing of individuals</em></strong></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">10. CONSUMER PROCESSES</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Consumers in Atlantis are modelled as biomass pools, age-structured biomass pools or age-structured groups. The age-structured groups are typically used for vertebrates and in the text below the terms age-structured groups and vertebrates may be used interchangeably. Non-vertebrates are largely modelled as biomass pools, which in age-structured biomass pools can be explicitly subdivided into ontogenetic stages (similar to stanzas in Ecosim).</p>
<p>The group types FISH, MAMMAL, SHARK, BIRD and FISH_INVERT are automatically assigned to age-structured groups. Other group types that have NumCohort=1 in the <em>functional_groups.csv</em> file are modelled as biomass pools, and if NumCohort&gt;1 they are modelled as age-structured biomass pools, where NumCohort parameter determines how many biomass pools to model.</p>
<section id="fluxes-in-consumer-biomass-pools" class="level2">
<h2 class="anchored" data-anchor-id="fluxes-in-consumer-biomass-pools"><strong>10.1. Fluxes in consumer biomass pools</strong></h2>
<p>In <strong>biomass pool or age-structured biomass pool consumers</strong> (CP in the following equations) the only variable tracked is N (i.e.&nbsp;not Si or the micronutrient; although when P and C tracking is enabled then N, P and C are all tracked for consumers). The flux through a consumer biomass pool is determined by growth (<em>G<sub>CP</sub></em>), natural mortality (<em>M<sub>CP</sub></em>), grazing (predation) for <em>i</em> predators (<em>Gr<sub>CP,i</sub></em>) and optional fishing mortality (<em>F<sub>CP</sub></em>). In addition, there is an optional encystment out of the system at certain times of the year or temperatures (<em>Ec<sub>out</sub></em>) and transfer back from cysts into the system when conditions are suitable (<em>Ec<sub>in</sub></em>).</p>
<p><strong>Biomass pool</strong> consumers maybe in the sediment, epibenthic layer or water column (depending on group type). A single N (P, C) pool is tracked per biomass pool age group (see Table 14):</p>
<p><span class="math display">\[\frac{d(CP)}{dt} = G_{PP} - M_{PP} - \sum_{i = predators}^{}{Gr_{PP,i}} - F_{CP} - Ec_{out} + Ec_{in}\]</span></p>
<p>In <strong>age-structured consumers</strong> (abbreviated as CX) the nitrogen pool is partitioned into the reserve (RN) and structural (SN) nitrogen of an average individual of each age group. Atlantis also tracks the numbers (Num) of individuals per age group. As a result for each age group three state variables are tracked – RN, SN and Num.</p>
<p><strong>Fluxes through the RN and SN pool</strong> are determined by growth (G<sub>CX</sub>), proportion of G<sub>CX</sub> allocated to SN versus RN (λ) and spawn (Sp<sub>CX</sub>), which is taken out of the RN pool on spawning (with timing defined in the <em>biology.prm</em> file, but typically once per year). Details determining λ are given in chapter 10.5.1. Note, that if respiration is included, then growth (G<sub>CX</sub>) can also be negative, and all energy required to cover respiration (or maintenance) costs will be taken out from the RN pool (see chapter 10.4)</p>
<p><span class="math display">\[\frac{d(RN_{CX})}{dt} = G_{CX} \bullet \lambda - Sp_{CX}\]</span></p>
<p><span class="math display">\[\frac{d(SN_{CX})}{dt} = G_{CX} \bullet (1 - \lambda)\]</span></p>
<p>The equations above show that RN pool can change through the year as it will suddenly decrease after the spawn. The SN pool cannot decrease.</p>
<p><strong>The flux of Num</strong> is tracked through individuals. The number of individuals in an age group depends on recruitment or ageing into the age group (<em>Nm<sub>CX-1,&nbsp;ageup</sub></em>), numbers ageing up into the next group (<em>Nm<sub>CX,&nbsp;ageup</sub></em>), natural mortality (<em>M<sub>CX</sub></em>), predation from <em>i</em> predators (<em>Gr<sub>CX,i</sub></em>), optional migration out (<em>T<sub>CXout</sub></em>) and into (<em>T<sub>CXin</sub></em>) the model domain and optional fishing mortality (<em>F<sub>CX</sub></em>).</p>
<p><span class="math display">\[\frac{d(Nm_{CX})}{dt} = Nm_{CX - 1,ageup} - Nm_{CX,ageup} - M_{CX} - \sum_{i = pred}^{}{Gr_{CX,i}} - F_{CX} - T_{CXout} + T_{CXin}\]</span></p>
<p>The numbers are converted to biomass as (SN + RN) · Nums.</p>
</section>
<section id="consumer-feeding" class="level2">
<h2 class="anchored" data-anchor-id="consumer-feeding"><strong>10.2. Consumer feeding</strong></h2>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong>What determines growth in consumers?</strong></p>
<p><strong>Growth in biomass pool consumers</strong> is determined by the intake or grazing (Gr) and assimilation efficiency. The consumed food or grazing term (Gr) is then assimilated according to the assimilation efficiencies for different food types (live, plant, labile detritus and refractory detritus). The unassimilated food is sent to the labile detritus, refractory detritus and ammonia pools according to the parameter determining detritus allocation (chapter 10.7), whereas all assimilated food is sent to growth.</p>
<p><strong>Growth in age-structured consumers</strong> is determined by the intake or grazing (Gr), assimilation efficiency and optional maintenance or respiration costs (Rs). The consumed food or grazing term (Gr) is then assimilated according to the assimilation efficiencies for different food types (live, plant, labile detritus and refractory detritus). The unassimilated food is sent to the labile detritus, refractory detritus and ammonia pools according to the parameter determining detritus allocation (chapter 10.7). The assimilated food represents a temporary energy pool (A). This A pool is used to meet the optional maintenance or respiration costs (Rs) and all remaining energy is allocated to SN and RN, i.e.&nbsp;to growth. The proportion of energy going into SN and RN is determined by λ, which is calculated at each time step dynamically depending on the individual’s condition and parameters determining energy allocation rules. The SN pool cannot decrease, whereas the RN pool can decrease, as it is used for reproduction and for meeting optional maintenance needs if assimilated food is insufficient.</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<p>The following chapters will describe these key processes: grazing (Gr), assimilation (A), maintenance (Rs) and energy allocation to SN and RN.</p>
<section id="grazing" class="level3">
<h3 class="anchored" data-anchor-id="grazing"><em>10.2.1 Grazing</em></h3>
<p>Grazing or predatory interactions are modelled in a similar way for both biomass pools and age-structured groups, except that age-structured and biomass pool groups have different options for refuge from predation. Feeding interactions are modelled through biomass, which in age-structured groups is then converted to numbers to track individual mortality. In Atlantis predatory interactions are determined by:</p>
<ol type="1">
<li><p>Physical overlap – prey and predator must be in the same cell at the same time (determined by vertical and horizontal distribution parameters), and if prey is in the sediment the predator must be able to reach it.</p></li>
<li><p>Diet connection matrix (pPREY matrix or detailed ontogenetic diet preferences) that indicate maximum availability of prey to a predator. The actual realised consumption will depend on refuge factors, but if the value in the pPREY matrix is set to 0, no predation will occur.</p></li>
<li><p>Gape limitation for age-structured prey – prey that is too small or too big for the predator (either age-structured or biomass pool) will not be consumed.</p></li>
<li><p>Habitat refuge.</p></li>
<li><p>Environmental factors (temperature, salinity, pH) that can modify predator’s feeding rates, prey’s availability and nutritional content.</p></li>
</ol>
<p>Throughout this chapter for brevity we will refer to both biomass pool (CP) and age-structured (CX) consumers as CX, as in many cases the processes are modelled in the same way for both groups; processes that are modelled differently will be identified throughout.</p>
<p>At the time of writing, Atlantis has twelve different options for modelling a predator’s feeding functional response to the prey’s biomass. There is a lot of theory and debate on what kind of functional response most accurately depicts predator’s behaviour (e.g.&nbsp;Hunsicker et al.&nbsp;2011) and this topic is not covered here.</p>
<p>Currently most Atlantis models use the modified Holling type II response, described in <a href="https://confluence.csiro.au/display/Atlantis/Useful+Reading?preview=/43155482/341447378/Link_et_al_2011_NEUS_tech_memo.pdf">Murray &amp; Parslow (1997)</a> for the Port Phillip Bay Integrated Model. The grazing term (<em>Gr</em>), or the amount of biomass of a specific prey (<em>prey</em>) consumed by a consumer CX (note, this now includes both CP and CX consumers), in the modified Holling type II response is calculated as</p>
<p><span class="math display">\[Gr_{prey} = \ \frac{B \bullet C \bullet B_{prey}^{*}}{1 + \frac{C \bullet \sum_{i}^{}\left( E_{i} \bullet B_{prey,i}^{*} \right)}{mum}}\]</span></p>
<p>where</p>
<p><span class="math display">\[B_{prey}^{*} = p_{prey,CX} \bullet \delta_{overlap} \bullet \delta_{habitat} \bullet \delta_{size} \bullet B_{prey}\]</span></p>
<p>is the available biomass of <em>prey</em> in the cell after taking into account all refuge (<em>δ</em>) options: <em>δ<sub>overlap</sub></em>, <em>δ<sub>habitat&nbsp;</sub></em>and <em>δ<sub>size</sub></em>. The refuge options are described in detail in the next chapter.</p>
<p><em>B</em> is the feeding biomass of a consumer (predator) CX in a given cell (mgN m<sup>-3</sup>) – a proportion of the consumer biomass may not be feeding if it is not active at that time of day or if it is spawning and has been identified as a group that does not feeding while spawning (feed_while_spawnXXX=0). <em>B<sub>prey</sub></em> is the biomass of prey (or fisheries catch available for consumption) in that cell (mgN m<sup>-3</sup>), <em>p<sub>prey,CX</sub></em> is the maximum availability (ranging from 0 to 1) of the <em>prey</em> to the predator CX defined in the pPREY matrix (or optional ontogenetic diet matrices), <em>C</em> is the clearance rate, similar to a search volume of the consumer CX, and <em>mum</em> is the maximum consumption rate, sometimes referred to as maximum growth rate, of the consumer CX.</p>
<p>The units of <em>C</em> and <em>mum</em> in CP consumers are m<sup>3</sup> mgN<sup>-1</sup> day<sup>-1</sup> and mgN mgN <sup>-1</sup> day<sup>-1</sup>. In CX consumers the units depend on the flagfishrates parameter, which defines whether rates are absolute or per unit of consumer biomass. If rates are absolute (flagfishrates=0) then <em>C</em> units are m<sup>3</sup> ind<sup>-1</sup> day<sup>-1</sup> and <em>mum</em> units are mgN ind<sup>-1</sup> day<sup>-1</sup>. If flagfishrates=1 then <em>C</em> units are m<sup>3</sup> mgN<sup>-1</sup> day<sup>-1</sup> and <em>mum</em> units are mgN mgN <sup>-1</sup> day<sup>-1</sup>.</p>
<p>The <em>E<sub>i</sub></em> is the assimilation efficiency of consumer CX on prey group category <em>i,</em> which represents the four prey group categories defined in Atlantis: living prey and fisheries catches, plant prey, labile detritus and carrion (ie. fisheries discards) and refractory detritus. <strong>Note that carrion is included in the labile detritus food category</strong>, and the EDL assimilation efficiency for species that feed on carrion should be higher than what it would be if the species was feeding on labile detritus alone.</p>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong>Use of assimilation efficiency <em>E<sub>i</sub></em> in the grazing term</strong></p>
<p>Even though assimilation efficiency is included in the grazing term <em>Gr</em> it <strong>does not</strong> define the final assimilated food, but is only used <strong>in modified Holling feeding</strong> responses (see Chapter 10.3) to scale the maximum consumption rate of a consumer. <strong>Higher assimilation efficiencies lead to lower Gr value</strong>, as the predator need not intake as much food as it can extract more energy from what it does consume.</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong><em>Should I use absolute or mass-specific</em> C <em>and</em> mum <em>rates (</em>flagfishrates)<em>?</em></strong></p>
<p>The flagfishrates parameter defines whether <em>mum</em> and <em>C</em> parameters are given per individual or per unit of body weight. It is important to remember that in Atlantis the realised size-at-age is dynamic and will change through time, depending on food availability. Setting flagfishrates to 0 or using absolute <em>C</em> and <em>mum</em> values means that regardless of the realised size-at-age <em>C</em> and <em>mum</em> values of an age group will stay the same throughout the simulation and Atlantis will behave more like an age-structured model. Using mass specific values (flagfishrates=1) means that <em>C</em> and <em>mum</em> will vary from year to year depending on the size of individuals in an age group, and behaviour of Atlantis will be closer to the size-structured models.</p>
<p>Regardless of whether absolute or mass-specific rates are used, separate <em>C</em> and <em>mum</em> parameters are required for each age group, so that C_XXX and mum_XXX strings in the <em>biology.prm</em> file contain as many values as there are groups in an age-structured functional group XXX. This means that Atlantis allows users to assume that the relationship between <em>C</em> and <em>mum</em> and body weight can change with ontogeny.</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</section>
<section id="what-are-the-c-and-mum-parameters" class="level3">
<h3 class="anchored" data-anchor-id="what-are-the-c-and-mum-parameters"><em>10.2.2 What are the</em> C <em>and</em> mum <em>parameters?</em></h3>
<p>Some Atlantis users have been confused about the meaning of <em>C</em> and <em>mum</em> parameters in the modified Holling representations. The <em>mum</em> parameter was initially adopted by Murray &amp; Parslow (1997), who replaced the standard Holling Type II maximum ingestion rate parameter (inverse of handling time) with a “maximum growth rate” <em>mum</em> by scaling it by assimilation efficiency:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>Origin of <em>mum</em> from Murray and Paslow 1997 (page 29):</strong></p>
<p>“In a classical paper, Holling (1966) discussed the theoretical and empirical basis of the functional response relating ingestion per consumer (G) to food density (P). He identified three functional forms:</p>
<p>I) G = min (C*P, Gmax) (bilinear),</p>
<p>II) G = C*P / (1 + C*P/Gmax) (rectangular hyperbola),</p>
<p>III) G = C*P<sup>2</sup> / (1 + C*P<sup>2</sup>/Gmax) (sigmoid or switching).</p>
<p>The parameter Gmax represents a maximum (food saturated) ingestion rate at high food densities, while C is a measure of grazing efficiency at low food densities. In Type I and II, the parameter C has units of volume cleared per grazer per unit time, and represents a maximum clearance rate.</p>
<p>…</p>
<p>In this model, we have used the rectangular hyperbola without thresholds, Type II, as the standard formulation. However, rather than specify the maximum ingestion rate Gmax, we have specified the maximum growth rate, "mum". This is related to Gmax through growth efficiency E, so that mum = Gmax*E, or Gmax = mum/E.”</p>
<p>The growth efficiency described above is the same as assimilation efficiency in Atlantis.</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td><p><strong>NOTE!</strong></p>
<p><strong>What is <em>C</em>?</strong></p>
<p>­<em>C</em> is often referred to as a clearance rate and it is defined as the volume of water searched, but it is different from an often used gut clearance rate that reflects food assimilation efficiency. The <em>C</em> parameter in Atlantis has units of m<sup>3</sup> ind<sup>-1</sup> day<sup>-1</sup> (or m<sup>3</sup> mgN<sup>-1</sup> day<sup>-1</sup>) and reflects the search or “cleared” volume. Note, however, that <em>C</em> is treated differently from true search volume (vl_XXX, vla_XXX, vlb_XXX) parameters used in predcase=5.</p>
<p>The true search volume parameters vl_XXX (for biomass pools) and vla_XXX and vlb_XXX (for age structured groups) are by default mass-specific and the relationship between body weight and search volume does not change. This means that only one entry is required, rather than a separate entry for each age group.</p>
<p>Further, for demersal species (flagdemXXX =1 in the <em>biology.prm</em> file) the search volume is multiplied by 0.5, but this scaling is not applied to the <em>C</em> parameter.</p>
<p><strong>And what is <em>mum</em>?!</strong></p>
<p>The <em>mum</em> parameter is only used in the modified Holling feeding responses (modified after Muray and Parslow, see above). Even though <em>mum</em> is called a maximum growth rate, it is included in the grazing (feeding) and not the growth equation, so it does not define the final growth. The consumed food will first be assimilated and the actual growth will then depend on other factors, such as respiration, reproduction and energy allocation to SN and RN.</p>
<p>As described in Muray and Parslow (1997) mum relates to the maximum ingestion rate (<em>Gmax</em>) as <em>mum = Gmax*E</em>, where <em>E</em> is the assimilation efficiency. The maximum ingestion rate is in turn the inverse of a more familiar “handling time” parameter (<em>ht</em>). Hence <em>mum</em> can also be seen as an inverse of the handling time as <em>mum=E/ht</em></p></td>
</tr>
</tbody>
</table>
<p>There is no clear consensus among currently used models as to the exact relationship between <em>C</em> and <em>mum</em> parameters. Theoretically the <em>mum</em> value should always be larger than <em>C</em>, but in some models and for some species the opposite is true. This is explored in Figure 10, which shows values of <em>Gr<sub>prey</sub></em> for different prey biomass, and different <em>C</em> and <em>mum</em> rates. In general mum sets the level of the eventual asymptote – the higher the <em>mum</em> the higher the realised feeding regardless of the <em>C</em> used. The ratio of <em>C</em> and <em>mum</em> dictates the steepness of the curve. As the ratio <em>C:mum</em> increases (i.e.&nbsp;the more that <em>C</em> exceeds <em>mum</em>) the gentler the curve, rising gradually in a smooth arc to the asymptote. As the ratio <em>C:mum</em> decreases (i.e.&nbsp;the more that <em>mum</em> exceeds <em>C</em>) the more the curve is converted to a flat rate across all but the lowest of prey biomass levels.</p>
<p><img src="media/image33.emf" style="width:5.21686in;height:3.56604in"></p>
<p><span id="_Toc526762790" class="anchor"></span>Figure 10. The value of grazing term (<em>Gr</em>) as a function of prey biomass (ranging from 0 to 1x of the predator biomass) and different assumptions on the ratio between <em>C</em> and <em>mum</em>. Predators biomass is 1000mgN, <em>C</em> = 100 m<sup>3</sup> ind<sup>-1</sup> day<sup>-1</sup>. The calculations assume only one prey, no refuge (<em>δ<sub>refuge</sub></em>=1), maximum availability p<sub>prey,CX</sub> of 1, and assimilation efficiencies <em>E<sub>prey,i</sub></em> of 1. Black: <em>mum</em> = <em>C,</em> orange: <em>mum</em> = <em>C</em>*3, blue: <em>mum</em> =<em>C</em>/5</p>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong><em>Ensuring meaningful prey choice and diets</em></strong></p>
<p>Atlantis <strong>does not</strong> implement optimal prey choice. The clearance rate <em>C</em> is specific to each predator but identical for all prey. Once all the available prey is assessed (based on overlap, size and habitat refuge) the consumption is applied <strong>uniformly</strong> <strong>across all available prey groups proportionally to the available prey biomass</strong> (prey biomass · pPREY). This means that if the available prey includes 1000mg of clams and 1mg of fish, and the clearance rate determines that only 10% of all available biomass can be consumed for a given time step, the predator will ingest 10% of available clam biomass and 10% of available fish biomass or 100mg of clams and 0.1mg of fish.</p>
<p>This has important implications for optimising the maximum available biomass p<sub>prey,CX</sub> in the prey availability matrix. The availability of biomass pool and especially detritus prey should be low for predators that prefer to eat fish. Otherwise a predator, such as a seal, might entirely fill up on invertebrate prey and impose no top-down control on fishes. Note, this can happen even if the availability of invertebrates to seals is as low as 0.001, as the final proportion in the diet is determined by availability and the biomass in the box. It is of crucial importance to <strong>carefully inspect realised diets</strong> from <em>DietCheck.txt</em> and <em>DetailedDietCheck.txt</em> output files, which can be analysed using for example atlantistools R package or other tools described in chapter 2.9.</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<table class="caption-top table">
<caption><span id="_Toc526762766" class="anchor"></span>Table 14. General feeding parameters and units</caption>
<colgroup>
<col style="width: 13%">
<col style="width: 86%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Parameter</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td colspan="2"><strong><em>Key parameters for modified Holling Type II functional response</em></strong></td>
</tr>
<tr class="even">
<td>predcase_XXX</td>
<td>Flag indicating the feeding functional response to use for a predator XXX</td>
</tr>
<tr class="odd">
<td>flagfishrates</td>
<td>Flag defining whether fully age-structured C_ and mum_ parameters are absolute (given per individual) or mass-specific (per unit of body mass)</td>
</tr>
<tr class="even">
<td>mum_XXX_T15</td>
<td>Maximum ingestion rate of biomass pools at 15C</td>
</tr>
<tr class="odd">
<td>C_XXX_T15</td>
<td>Clearance rate of biomass pools at 15C</td>
</tr>
<tr class="even">
<td>mum_XXX</td>
<td>Age specific maximum ingestion rate for age structured groups: mgN ind<sup>-1</sup> day<sup>-1</sup> or mgN mgN<sup>-1</sup> day<sup>-1</sup></td>
</tr>
<tr class="odd">
<td>C_XXX</td>
<td>Age specific clearance rate for age structured groups: m<sup>3</sup> mgN<sup>-1</sup> day<sup>-1</sup> or m<sup>3</sup> ind<sup>-1</sup> day<sup>-1</sup></td>
</tr>
<tr class="even">
<td><p>pPREY1XXX1 pPREY1XXX2</p>
<p>pPREY2XXX1</p>
<p>pPREY2XXX1</p></td>
<td>Maximum availability of prey to a predator XXX (given as a vector with the column the prey group in the same order as in the <em>functional_groups.csv</em> file). Four values are given for each predator-prey combination: juv-juv, juv-ad, ad-juv, ad-ad.</td>
</tr>
<tr class="odd">
<td>E_XXX</td>
<td>Assimilation efficiency when feeding on animal prey</td>
</tr>
<tr class="even">
<td>EPlant_XXX</td>
<td>Assimilation efficiency when feeding on plant prey</td>
</tr>
<tr class="odd">
<td>EDR_XXX</td>
<td>Assimilation efficiency when feeding on refractory detritus</td>
</tr>
<tr class="even">
<td>EDL_XXX</td>
<td>Assimilation efficiency when feeding on labile detritus</td>
</tr>
<tr class="odd">
<td colspan="2"><strong>Parameters for optional further details</strong></td>
</tr>
<tr class="even">
<td>flag_fine_ontogenetic_diets</td>
<td>Flag indicating whether more refined, age-specific, prey availability should be used (so an availability value is required per predator age class rather than per stage (typically juvenile and adult))</td>
</tr>
<tr class="odd">
<td>p_split_YY</td>
<td>Flag identifying prey groups YY for which age-specific diets should be given</td>
</tr>
<tr class="even">
<td>age_structured_prey_XXX</td>
<td>Flag identifying predators for which age-specific diets should be given</td>
</tr>
<tr class="odd">
<td>p_YYXXX</td>
<td>A vector of maximum prey availability for each combination of prey YY and predator XXX identified in p_split_YY and age_structured_prey_XXX parameters</td>
</tr>
</tbody>
</table>
</section>
<section id="what-determines-prey-biomass-available-for-predation" class="level3">
<h3 class="anchored" data-anchor-id="what-determines-prey-biomass-available-for-predation"><strong><em>10.2.3. What determines prey biomass available for predation?</em></strong></h3>
<p>The proportion of prey biomass available to a predator at any given time is determined dynamically as</p>
<p><span class="math display">\[B_{prey}^{*} = p_{prey,CX} \bullet \delta_{overlap} \bullet \delta_{habitat} \bullet \delta_{size} \bullet B_{prey}\]</span></p>
<p>This means that the available prey biomass depends on:</p>
<ol type="1">
<li><p>Static parameter p<sub>prey,CX</sub> (which can range from 0 to 1) defined in the pPREY matrix (or optional ontogenetic diet matrices)</p></li>
<li><p>The <em>δ<sub>overlap</sub></em> refuge defined by co-occurrence in the same cell at a same time step and the predator is active at that time of day. This is determined by horizontal and vertical distribution as well as activity parameters.</p></li>
<li><p>The <em>δ<sub>overlap</sub></em> refuge also defined by the predator’s ability to access at least one of the habitats inhabited by prey. This is determined by the <strong>static</strong> habitat_XXX parameter and is activated only if a secies is habitat dependent (see below)</p></li>
<li><p>The <em>δ<sub>size</sub></em> refuge for age structured prey. This is determined by gape limitation of the predator relative to the prey size.</p></li>
<li><p>The <em>δ<sub>habitat</sub></em> refuge for infaunal (_INF) invertebrates (CX) defining access to biomass pool prey buried in the sediment. This is determined by the depth of the oxygen layer and depth predators can dig into</p></li>
<li><p>The optional <em>δ<sub>habitat</sub></em> refuge for age structured prey. This is determined by optional habitat dependency and habitat refuge parameters.</p></li>
</ol>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong>What is <em>p<sub>prey,CX</sub></em>?</strong></p>
<p>This parameter defines the maximum proportion of the prey biomass available to a consumer at a given time. If &lt; 1 then it means that at any given time the consumer cannot access all the prey biomass even if it can fit the prey into its mouth and the prey is not protected by a refuge.</p>
<p>The parameter is similar to the vulnerability parameter in EwE and is influenced by the feeding arena theory.</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<p>The <em>δ<sub>overlap&nbsp;</sub></em>is dependent on the physical overlap of prey and predator. It is determined by:</p>
<ol type="1">
<li><p>horizontal and vertical distribution parameters that define which cell and which distribution type (water column, sediment, epibenthic) each functional group is found in (see Distribution and Movement section below). Feeding of water column predators on sediment prey is determined by the depth consumers can dig into the sediment, whereas predators living inside the sediment cannot feed on the water column prey</p></li>
<li><p>period of the day that a group is active (a group that is not active during that period of the day does not eat, but is available for consumption, see below),</p></li>
</ol>
<p>Atlantis determines whether a prey and predator (both age structured and biomass pools) can access same habitats. If a predator <strong>cannot access any of the habitats inhabited by the prey</strong> (has 0 for prey habitat types), then it also cannot access any prey biomass associated with that habitat type. If a predator <strong>can access at least one</strong> of the habitats that the prey is associated with, then it is assumed to have <strong>access to all of the prey biomass</strong>.</p>
</section>
<section id="habitat-refuge" class="level3">
<h3 class="anchored" data-anchor-id="habitat-refuge"><strong><em>10.2.4. Habitat refuge</em></strong></h3>
<p>The <em>δ<sub>habitat&nbsp;</sub></em>is the <strong>optional prey habitat refuge</strong> which is activated <strong>only</strong> when <strong>all</strong> of the points below are true:</p>
<ol type="1">
<li><p>The general habitat dependency flag flaghabdepend is set to 1</p></li>
<li><p>habdepend_XXX is &gt;0 for the specific prey age-stuctured prey group</p></li>
<li><p>flag_refuge_model &gt; 0, which will activate the standard (=1) or rugosity related (=2) refuge model</p></li>
<li><p>prey is in the bottom water column, where water is in contact with the epibenthic habitats and sediment</p></li>
</ol>
<p>The habitat refuge is calculated in the <em>Vertebrate_Assess_Enviro()</em> routine in <strong>atvertprocesses.c</strong></p>
<p>The <em>δ<sub>habitat&nbsp;</sub></em>is used to reflect the assumption that for <strong>age-structured prey</strong> all habitats can provide some degree of refuge even when predators can access the habitat the prey inhabits. The <em>δ<sub>habitat&nbsp;</sub></em> = 1 for prey species that are not dependent on habitat (XXX_habdepend set to 0), whereas for habitat dependent species it is defined either as a simple habitat refuge (flag_refuge_model =1) or rugosity related (flag_refuge_model=2).</p>
<p>A <strong>simple habitat refuge</strong> is calculated as:</p>
<p><span class="math display">\[\delta_{habitat} = Acov_{prey} \bullet \left( e^{\left( - K_{prey} \bullet Cover_{habitat} + Bcov_{prey} \right)} + \frac{1}{K_{prey}} \right)\]</span></p>
<p>where <em>Cover<sub>habitat</sub></em> is the weighted relative cover in the cell for the prey, <em>Acov<sub>prey</sub></em> (Acov_ad_XXX and Acov_juv_XXX) is a scalar of the overall habitat refuge effect for prey <em>i</em> , <em>Bcov<sub>prey</sub></em> (Bcov_ad_XXX and Bcov_juv_XXX) is the habitat steepness coefficient, <em>K</em><sub>prey</sub> (Kcov_ad_XXX and Kcov_juv_XXX) is the exponent of refuge provided by the habitat.</p>
<p>The availability of suitable cover is calculated as</p>
<p><span class="math display">\[Cover_{habitat} = \ \left( \delta_{substrate,habdegrad} \bullet p_{substrate} + p_{biogenic} \right) \bullet \left( 1 + p_{canyon} \right)\]</span></p>
<p>where <em>δ <sub>substrate,habdegrad</sub></em> is degradation in the physical habitat due to coastal development (set by the flagdegrade flag, which also controls other habitat degradation parameters), <em>p<sub>substrate</sub></em> is the proportion of the cell covered with suitable substrate types, <em>p<sub>biogenic</sub></em> is the proportion of the cell covered by suitable biogenic habitats (determined by the isCover parameter in the <em>functional_groups.csv</em>), <em>p<sub>canyon</sub></em> is the proportion of the cell covered by canyons. Note that canyons are treated differently to other habitats and, for species that live in canyons (set through the habitat_XXX vector) the canyon acts as an enhancement factor (multiplier), where 10% of canyon area in the cell will enhance the habitat cover to 1.1. This is because canyons are known to concentrate production, but their absence does not prevent the establishment and growth of the groups.</p>
<p><strong>Rugosity related habitat refuge</strong> is <strong>only</strong> available for</p>
<ol type="1">
<li><p>models that include corals or sponges and</p></li>
<li><p>is only used for species that are dependent on (interact with) corals.</p></li>
</ol>
<p>Further description of the rugosity related habitat cover is available on the wiki dealing with “Calculation of rugosity related habitat refuge” - <a href="https://confluence.csiro.au/display/Atlantis/2016/09/16/Calculation+of+rugosity+related+habitat+refuge">here</a> (it cover’s models by Bozec and Blackwood in detail).</p>
<p>If flag_refuge_model=2 but a species does not live on corals, then the simple refuge model described above is applied. Three extra parameters are needed for rugosity refuge model: RugCover_Coefft, RugCover_Const, RugCover_Cap.</p>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong>Calculating the amount of habitat cover available</strong> <em>Cover<sub>habitat</sub></em></p>
<p>The amount of habitat available for the species can be calculated either as a sum of total accessible habitat or as an average proportion of suitable habitats. This is controlled by flag_rel_cover parameter and will give <strong>very different habitat cover outcomes</strong>! For example, a cell that has three suitable habitats, covering 10%, 20% and 30% of the cell area respectively gives the following:</p>
<p>If flag_rel_cover is set to 0 the amount of available cover will be 0.1+0.2+0.3=0.6</p>
<p>If flag_rel_cover is set to 1 the amount of available cover will be (0.1+0.2+0.3)/3=0.2</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<p>The habitat refuge can be interpreted as a scalar on the available prey biomass determined by the available suitable habitat cover in the cell.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="media/image34.emf" style="width:4.42569in;height:4.25069in" class="figure-img"></p>
<figcaption><span id="_Toc526762791" class="anchor"></span>Figure 11. Habitat refuge scalar on prey availability as a function of cell area covered with suitable habitats (see box above for details on calculations of suitable cover area).</figcaption>
</figure>
</div>
<p><strong>Black</strong>: Acov=1, Bcov=0.6, Kcov=3 (parameters similar to SETas model and originally derived from a meta-analysis of prey accessibility on coral and temperate reefs)</p>
<p><em>Effect of Kcov:</em></p>
<p><strong>Orange</strong>: Acov=1, Bcov=0.6, Kcov=2</p>
<p><strong>Red</strong>: Acov=1, Bcov=0.6, Kcov=1</p>
<p><em>Effect of Bcov:</em></p>
<p><strong>Light blue</strong>: Acov=1, Bcov=0.4, Kcov=3</p>
<p><strong>Dark blue</strong>: Acov=1, Bcov=0.8, Kcov=3</p>
<p>The Acov is a linear scalar that only affects the height of the curve along the y axis. If needed it could be used to scale prey availability to 1 when cover=0</p>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p>When habitat dependency and refuge are used then the models are often parameterised so that <strong>prey availability is upscaled (&gt;1) when a cell contains zero available habitat</strong> (as prey are more exposed than normal to predators). It is assumed that normally around 0.2-0.3 of the cell will have suitable habitat, which is why prey availability scalar is ~1 at this proportion of cover available (see Fig. 11). This is based on a (now &gt;10 year old) meta-analysis of prey accessibility on coral and temperate reefs.</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong><em>Limitations of current implementation of habitat refuge</em></strong></p>
<ol type="1">
<li><p>The curve of habitat refuge does not have a final inflection that would match the case where even good quality habitat has become saturated and fails to provide any refuge for a larger proportion of the total population.</p></li>
<li><p>The curve is deterministic and time invariant so there is no explicit dynamic trade-off between predation risk and hunger-driven searching in open ground as there is in Ecosim (Walters et al 1997).</p></li>
<li><p>This approach ignores the use of cover by predators, where improved cover can actually lead to higher predation.</p></li>
</ol></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<p>For <strong>biomass pools</strong> (CP) the <em>δ<sub>habitat&nbsp;</sub></em>refuge is available only for prey living in the <strong>sediments</strong> and is calculated by the depth the predators can dig into (set in KDEP_XXX) and depth of the oxygenated layer sedoxdepth, calculated and reported in the <em>output.nc</em> file, see Chapter 5.6). If sedoxdepth &lt; KDEP then no refuge is provided by the sediment (<em>δ<sub>habitat</sub></em> = 1), if sedoxdepth &gt; KDEP then</p>
<p><em>δ<sub>habitat</sub></em> = (sedoxdepth - KDEP)/ sedoxdepth,</p>
<p>For example, if the oxygenated layer depth is twice as deep as the sediment penetration depth, then only half of the sediment living biomass pool will be available (and this will be further scaled by <em>p<sub>prey,CX</sub></em> value). If sedoxdepth=0 a small number (1e-08) is added to avoid division by zero</p>
<table class="caption-top table">
<caption><span id="_Toc526762767" class="anchor"></span>Table 15. Parameters defining habitat associations and habitat refuge.</caption>
<colgroup>
<col style="width: 3%">
<col style="width: 96%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Parameter</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>flaghabdepend</td>
<td>Flag turning on habitat dependency routines. If it is set to 0, all habitat associations and routines are ignored.</td>
</tr>
<tr class="even">
<td>XXX_habdepend</td>
<td>Flag identifying which age structured groups are habitat dependent</td>
</tr>
<tr class="odd">
<td>habitat_XXX</td>
<td>A vector of values identifying which of the available habitat preferences for biomass pool group XXX. Traditionally these used to be only 0 or 1 values, indicating absence or presence in each habitat. Now more resolved setting is allowed. A value &gt; 0 indicated that the organism prefers the habitat and of &lt; 0 it avoids it. The absolute value indicates the relative weighting, where proportion of suitable habitat is calculated as a multiplier of habitat proportion and habitat preference given in habitat_XXX vector.</td>
</tr>
<tr class="even">
<td><p>juv_habitat_XXX</p>
<p>ad_habitat_XXX</p></td>
<td>Same as above but applied for age structured groups and setting available habitats for juvenile and adult life history stages separately</td>
</tr>
<tr class="odd">
<td>flag_refuge_model</td>
<td>If set to 0, no habitat refuge for age structured groups will be applied. If set to 1 the standard refuge is calculated as described above. If set to 2 the habitat refuge is rugosity related</td>
</tr>
<tr class="even">
<td>flag_rel_cover</td>
<td>A flag indicating whether to use cumulative habitat (0) or average relative cover (1) when interacting with predators</td>
</tr>
<tr class="odd">
<td><p>Kcov_juv_XXX</p>
<p>Kcov_ad_XXX</p></td>
<td>exponent of refuge provided by the habitat for age structured groups (provided for juveniles and adults)</td>
</tr>
<tr class="even">
<td><p>Acov_juv_XXX</p>
<p>Acov_ad_XXX</p></td>
<td>scalar of the overall habitat refuge for age structured groups (provided for juveniles and adults)</td>
</tr>
<tr class="odd">
<td><p>Bcov_juv_XXX</p>
<p>Bcov_ad_XXX</p></td>
<td>habitat steepness coefficient for age structured groups (provided for juveniles and adults)</td>
</tr>
<tr class="even">
<td>KDEP_XXX</td>
<td>depth consumers can dig into the sediment, in meters. Used to determine habitat refuge for prey digging in the sediments</td>
</tr>
<tr class="odd">
<td>isCover in .csv</td>
<td>Which epibenthic groups also serve as a habitat</td>
</tr>
</tbody>
</table>
</section>
<section id="size-refuge-from-predation" class="level3">
<h3 class="anchored" data-anchor-id="size-refuge-from-predation"><strong><em>10.2.5. Size refuge from predation</em></strong></h3>
<p>The <strong>non-optional size refuge of age-structured prey</strong> <em>δ<sub>size&nbsp;</sub></em>is defined by gape limitation, which is used to simulated size selectivity and physical limitation of predators when feeding (i.e.&nbsp;what can fit in their mouth). The gape limitation can be calculated in two ways – <strong><em>hard feeding window</em></strong> or <strong><em>smooth feeding curve</em></strong> (defined by the UseHardFeedingWindow flag)</p>
<p>The hard feeding window defines knife-edge size selectivity, where availability of the prey is either zero (prey not available to the predator) or one (prey available). The prey is available to the predator if its size falls within the lower and upper prey selection size limits (KLP_XXX and KUP_XXX), or gape size, of the predator. In these calculations <strong>size is defined by structural nitrogen (SN) only</strong>!</p>
<p><span class="math display">\[\delta_{size} = \ \left\{ \begin{array}{r}
= 1,\ \ if\ KLP \bullet SN &lt; SN_{prey} &lt; KUP \bullet SN \\
= 0,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ otherwise\
\end{array} \right.\ \]</span></p>
<p>In many models the lower and upper limits are 0.1% and ca 40% of the predator size respectively; so the predator of 1000mg SN could consume age structured prey with from 1 to 400mg (KUP ranges from 15 to 80%).</p>
<p>The smooth feeding window models a smoother transition of prey availability and is set by UseHardFeedingWindow=0. The original implementation of the smooth feeding window used a humped window calculation; now defined with an additional flag UseHumpedFeedingWindow=1. If humped window is used the availability of prey on the upper predator’s size limit is calculated as</p>
<p><span class="math inline">\(\delta_{size} = relSize\  \bullet e^{\left( Kmax \bullet (1 - relSize) \right)}\)</span>, where</p>
<p><span class="math display">\[relSize = \frac{SN_{prey}}{SN \bullet KUP}\]</span></p>
<p>represents <strong>relative size</strong> of the prey compared to the predator’s upper size limit (<em>KUP</em>), and <em>Kmax</em> (Kmax_coefft_XXX) is the steepness of the smooth selectivity curve.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="media/image35.png" style="width:4.73542in;height:3.76389in" class="figure-img"></p>
<figcaption><span id="_Toc526762792" class="anchor"></span>Figure 12. Prey availability scalar Size_Scalar<sub>prey</sub> of different sized prey for different Kmax_coefft values for humped selectivity curve.</figcaption>
</figure>
</div>
<p><strong>Black</strong>: <em>Kmax</em> = 2</p>
<p><strong>Orange</strong>: <em>Kmax</em> = 1</p>
<p><strong>Red</strong>: <em>Kmax</em> = 3</p>
<p><strong>Blue</strong>: <em>Kmax</em> = 5</p>
<p>Predators SN=10mg and KUP=0.4 (shown by vertical blue line). The horizontal black line shows that the maximum value of δ<sub>size</sub> is set to 1 (values larger than one are capped at 1)</p>
<p>As Fig. 12 shows, the humped window calculation is very sensitive to the Kmax_coefft_XXX parameter, where availability of prey at lower size limit can increase very rapidly. An alternative formulation is now available as a logistic shaped curve to calculate δ<sub>size</sub>. This option is appplied if UseHardFeedingWindow = 0 and UseBiLogisticFeedingWindow= 1 <strong>and it is based on total length rather than SN of predator and prey</strong></p>
<p><span class="math display">\[\delta_{size} = \ \left\{ \begin{array}{r}
= \frac{1}{1 + e^{\left( - Kmax \bullet \left( Len_{prey} - Len_{prey,50\% KLP} \right) \right)}},\ \ if\ Len_{prey} &lt; Avail_{top} \bullet Len_{pred} \\
= \frac{1}{1 + e^{\left( Kmax \bullet \left( Len_{prey} - Len_{prey,50\% KUP} \right) \right)}},\ \ \ \ \ \ \ \ \ \ if\ Len_{prey} &gt; Avail_{top} \bullet Len_{pred}
\end{array} \right.\ \]</span></p>
<p>where <em>Kmax</em> is the steepness of the logistic selectivity curve (Kmax_coefft_XXX), <em>Len<sub>prey,50%KLP</sub></em> and <em>Len<sub>prey,50%KUP</sub></em> are midpoints of the logistic selectivity curve or length of prey at which availability is half of the maximum possible value. The <em>Avail<sub>top</sub></em> is the length of prey for which availability is highest.</p>
<p>The <em>Avail<sub>top</sub></em> is calculated as a midpoint between the KLP and KUP values, hence assuming a symmetrical selectivity curve. For example, if the KLP=0.2 and KUP=0.6, the <em>Avail<sub>top</sub></em> = 0.4. Similarly the <em>Len<sub>prey,50%KLP</sub></em> is the midpoint between the lower (KLP_XXX) predator size limits and the <em>Avail<sub>top</sub></em>, and <em>Len<sub>prey,50%KUP</sub></em> is the midpoint between the upper (KUP_XXX) predator size limits and the <em>Avail<sub>top</sub></em>. In the example above the <em>Len<sub>prey,50%KLP</sub></em> = 0.3 and <em>Len<sub>prey,50%KUP</sub></em> = 0.5.</p>
<p>Note, that if the steepness of the curve (<em>Kmax</em> value) is low, the the δ<sub>size</sub> in the equation above may never reach 1 (see Figure 13). It is NOT recommended to use Kmax values lower than 0.5 because it makes the feeding window very wide and allows feeding on almost all sizes of prey (orange line in Fig. 13).</p>
<p><img src="media/image36.png" style="width:4.71875in;height:3.69028in">The bilogistic feeding window uses length rather than SN of prey and predator, because large differences between SN (many orders of magnitude) makes the size scalar highly sensitive to the Kmax parameter.</p>
<p><span id="_Toc526762793" class="anchor"></span>Figure 13. Prey availability scalar δ<sub>size</sub> of different sized prey for bilogistic selectivity curve.</p>
<p><strong>Black</strong>: Kmax = 1, KLP=0.2, KUP=0.6</p>
<p><strong>Red</strong>: Kmax=0.5 , KLP=0.2, KUP=0.6</p>
<p><strong>Orange</strong>: Kmax = 0.2, KLP=0.2, KUP=0.6</p>
<table class="caption-top">
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong>Calculating length in age-structured groups and biomass pools</strong></p>
<p>If length-based selectivity is selected for a fishery, it will be applied to both age-structured groups and biomass pools. The application of length-based selectivity to biomass pools is a new feature in Atlantis and it is important to get it right, or else invertebrates may not be caught by the gear (see wiki post <a href="https://confluence.csiro.au/pages/viewpage.action?spaceKey=Atlantis&amp;postingDay=2016%2F6%2F2&amp;title=Invertebrate+size+calculations+for+use+in+size+based+selectivity">here</a>)</p>
<p>Length of an age group in age-structured groups is calculated using length-weight conversion parameters (li_a_XXX and li_b_XXX) given in the <em>biology.prm</em> file. For this, first, the structural and reserve nitrogen (RN+SN, in mg) are added up and converted to wet weight in grams (<em>wgt</em>) as:</p>
<p><span class="math display">\[wgt = (RN + SN) \bullet wetdry \bullet X_{CN}/1000\]</span></p>
<p>where <em>wetdry</em> is the wet weight to ash free dry weight ratio (k_wetdry in <em>biology.prm</em>) typically set to 20 in many Atlantis parameter files, based on using C as a proxy for dry weight (but noting that in many models and literature the wet : dry ratio used is often closer to 6-8) and <em>X_CN</em> is the carbon to nitrogen Redfield ratio (X_CN in <em>biology.prm</em>) typically set to 5.7.</p>
<p>The <em>wgt</em> (in grams) is then converted to length (in cm) using the standard equation</p>
<p><span class="math inline">\(wgt = a \bullet {length}^{b}\)</span> or <span class="math inline">\(length = \left( \frac{wgt}{a} \right)^{1/b}\)</span></p>
<p>where <em>a</em> is li_a_XXX and <em>b</em> is li_b_XXX in the <em>biology.prm</em>. Note that these parameters could be set in such a way to return length in metres instead, but by convention it is in cm (as are any other faunal lengths).</p>
<p>Since for <strong>biomass pools</strong> only one nitrogen pool is tracked (individuals are not tracked separately), the structural nitrogen of an average individual must be given in the <em>biology.prm</em> file. This is given in the XXX_sn parameter for each consumer biomass pool group (not plants, bacteria or detrital pools). In addition to the length-based selectivity, this SN value is used in length-based feeding interactions when biomass pool predators feed on the age-structured prey (see chapter 10.2.5).</p>
<p>The length of an average biomass pool invertebrate is calculated in the same way as for age structured groups above. However, before the calculation the SN is converted to the SN+RN weight using the X_RS ratio parameter in the <em>biology.prm</em> file, so that</p>
<p><span class="math display">\[wgt = \ (1.0 + X\_ RS) \bullet SN\]</span></p>
<p>hence assuming that the ratio of hypothetical RN and SN in an invertebrate is optimal. <strong>The length-weight conversion parameters li_a_invert and li_b_invert given in the <em>biology.prm</em> are identical for all biomass pool species.</strong></p></th>
</tr>
</thead>

</table>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong>Smooth and hard feeding window</strong></p>
<p>Applying hard feeding window (knife-edge selectivity) means that very small changes in prey’s size can abruptly change their availability from 0 to 1. Although this approach is used in a range of ecological models it can lead to abrupt changes in growth or predation mortality between cohorts.</p>
<p>If smoother transition on size selectivity is desired, a smooth feeding window should be used. Note, however, that the “humped” implementation of the smooth feeding curve extends the availability of prey above the upper gape limit (KUP_XXX) of the predator (Fig. 12). The curve is also very sensitive to the Kmax_coefft parameter. Applying this smooth feeding curve might require decreasing the KUP_XXX values.</p>
<p>When using bilogistic curve the prey availability is generally decreased compared to the hard feeding window – the availability is equal to that of hard feeding window only for a small size range of the prey (Fig. 13). This means that when changes from hard to bilogistic curve are applied, the overall prey availability may have to be increased to ensure enough food for the predator.</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<table class="caption-top table">
<caption><span id="_Toc526762768" class="anchor"></span>Table 16. Parameters defining size refuge for age structured groups</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 79%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Parameter</strong></th>
<th style="text-align: left;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">KLP_XXX</td>
<td style="text-align: left;">Min gape limit of the predator (age structured or biomass pool)</td>
</tr>
<tr class="even">
<td style="text-align: left;">KUP_XXX</td>
<td style="text-align: left;">Max gape limit of the predator (age structured or biomass pool)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">UseHardFeedingWindow</td>
<td style="text-align: left;">Flag setting up hard (0) or smooth (1) feeding window</td>
</tr>
<tr class="even">
<td style="text-align: left;">UseBiLogisticFeedingWindow</td>
<td style="text-align: left;">Flag indicating whether using humped (0) or bi-logistic (1) smooth feeding window</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kmax_coefft_XXX</td>
<td style="text-align: left;">Steepness of the smooth feeding window curve of the predator</td>
</tr>
<tr class="even">
<td style="text-align: left;">XXX_sn</td>
<td style="text-align: left;">Typical size (amount of SN) of a biomass pool consumer to determine the size of age structured prey available to it</td>
</tr>
</tbody>
</table>
</section>
<section id="availability-of-fisheries-catches-to-opportunistic-catch-eaters" class="level3">
<h3 class="anchored" data-anchor-id="availability-of-fisheries-catches-to-opportunistic-catch-eaters"><strong><em>10.2.6. Availability of fisheries catches to opportunistic catch-eaters</em></strong></h3>
<p>The availability of fisheries catches is an optional set of parameters that allow groups to access additional prey. Proportion of catch available from each fishery (set in PropCatch_XXX parameter) is added to the total available prey. No gape limitation (size refuge) is applied to fisheries catches.</p>
<table class="caption-top table">
<caption><span id="_Toc526762769" class="anchor"></span>Table 17. Parameters defining feeding on fisheries catches</caption>
<colgroup>
<col style="width: 9%">
<col style="width: 90%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Parameter</strong></th>
<th style="text-align: left;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">isCatchGrazer in .csv file</td>
<td style="text-align: left;">Identifies species that can feed on fisheries catches</td>
</tr>
<tr class="even">
<td style="text-align: left;">pFCXXX</td>
<td style="text-align: left;">A vector of values (0 and 1) identifying which of the fisheries catches are available to each catch eating species identified as isCatchGrazer. The vector should be as long as there are fisheries in the <em>fisheries.csv</em> file (assumes the same order as given in the <em>fisheries.csv</em> file).</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PropCatch_XXX</td>
<td style="text-align: left;">Proportion of the catch in each fishery that can be exploited by the isCatchGrazer groups</td>
</tr>
</tbody>
</table>
</section>
<section id="effect-of-temperature-and-salinity-on-feeding-parameters" class="level3">
<h3 class="anchored" data-anchor-id="effect-of-temperature-and-salinity-on-feeding-parameters"><em>10.2.7. Effect of temperature and salinity on feeding parameters</em></h3>
<p>Feeding rates and assimilation efficiencies will be temperature dependent if a species is temperature sensitive. Salinity dependency is optional. See chapter13 for further details.</p>
</section>
<section id="effect-of-oxygen-limitation-on-epibenthic-invertebrate-feeding-rates" class="level3">
<h3 class="anchored" data-anchor-id="effect-of-oxygen-limitation-on-epibenthic-invertebrate-feeding-rates"><em>10.2.8. Effect of oxygen limitation on epibenthic invertebrate feeding rates</em></h3>
<p>Oxygen limitation affects the feeding rates of SED_EP_FF, MOB_EP_OTHER, SED_EP_OTHER, SM_INF, LG_INF, CORAL and SPONGE functional groups (applied in group routines <em>Epibenthic_Ivert_Process()</em>, <em>Invert_Consumer_Process()</em> and <em>Coral_Process()</em>). This dependency is also an option for age structured groups in newer code releases that are currently in the pipeline.</p>
<p>The oxygen limitation scalar <em>δ<sub>O2</sub></em> is applied to clearance rate <em>C</em>. Atlantis has four options to calculate oxygen limitation scalar, set by O2case parameter. The oxygen limitation scalar is calculated by <em>Oxygen()</em> function in <strong><u>atprocess.c</u></strong></p>
<p><strong>1. Ambient oxygen limitation</strong> (O2case=0) uses ambient oxygen levels O<sub>amb</sub>, lethal oxygen concentration (KO2_XXX, mgO2 m<sup>-3</sup>) and limiting oxygen concentration (KO2lim_XXX, mgO2 m<sup>-3</sup>) parameters. Remember that oxygen solubility in seawater at 5C and 1bar pressure is 10 mg/l or 10000 mg m<sup>-3</sup>.</p>
<p><img src="media/image37.wmf" class="img-fluid"></p>
<p><img src="media/image38.png" style="width:4.33889in;height:3.10347in"></p>
<p><span id="_Toc526762794" class="anchor"></span>Figure 14. Oxygen limitation scalar <em>δ<sub>O2&nbsp;</sub></em>for different ambient oxygen concentrations, assuming KO2=50 mgO2 m<sup>-3</sup> and KO2lim = 100 mgO2 m<sup>-3</sup>.</p>
<p><strong>2. Depth based limitation</strong> (O2case=1) only uses sediment depth of half oxygen mortality mD (mD_XXX, m) parameter and depth of the oxygenated sediment layer sedoxdepth (see chapter 5.6) where</p>
<p>δ<sub>O2</sub>=sedoxdepth/(sedoxdepth+mD)</p>
<p>This limitation only reflects reduced feeding within the sediment due to low oxygen conditions, so it is mostly relevant to epibenthic invertebrate biomass pools that can dig into sediment for food or infauna.</p>
<p><strong>3. IGBEM based limitation</strong> (O2case=2) is modified after the ERSEM model and is calculated as:</p>
<p>δ<sub>O2</sub>=O<sub>amb</sub>/(KO2+O<sub>amb</sub>), where O<sub>amb</sub> is the concentration of oxygen in the cell</p>
<p><strong>4. Quadratic limitation</strong> (O2case=3) calculates both ambient and depth based limitation (points 1 and 2 above) and uses the larger of the two values as the oxygen scalar δ<sub>O2</sub></p>
</section>
<section id="effect-of-space-limitation-on-epibenthic-invertebrate-feeding-rates" class="level3">
<h3 class="anchored" data-anchor-id="effect-of-space-limitation-on-epibenthic-invertebrate-feeding-rates"><em>10.2.9. Effect of space limitation on epibenthic invertebrate feeding rates</em></h3>
<p>Space limitation can affect <em>C</em> or <em>mum</em> rates of benthic invertebrate biomass pools if:</p>
<p>1) A biomass pool group XXX is infauna or a filter feeder or mobile epibenthic group (SED_EP_FF and MOB_EP_OTHER GroupType) <strong>and</strong> is habitat dependent (habdependXXX=1) <strong>and</strong> space limitation is active (flagXXXlim=1 or 2). If these three conditions are satisfied then the Crowding Effect scalar is applied to the clearance rate <em>C</em> of XXX (see chapter 10.5.3).</p>
<p>2) A biomass pool group is habitat dependent (with at least some habitat preference parameters not set to 1), benthic and flag_benthos_sediment_link=1. See chapter 10.5.3 for further details.</p>
</section>
<section id="other-factors-affecting-feeding-parameters" class="level3">
<h3 class="anchored" data-anchor-id="other-factors-affecting-feeding-parameters"><em>10.2.10. Other factors affecting feeding parameters</em></h3>
<p>The feeding interactions described above are further dynamically modified by a range of ecological and environmental factors, such as species activity, starvation, or pH.</p>
<p><strong>Species activity</strong></p>
<p>Atlantis has an option to set whether a species is active during the day or night, or all the time. This is done using flagXXXday parameter. It is important to note that if a diurnal timestep is used (i.e.&nbsp;12h or less) and if a species activity preference is set to day or night, it will not be active in the model during the other half of the day – it will not initiate ecological processes such as eating, but can still be preyed upon.</p>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p>If a species is only active during the day or night (flagXXXday set to 0 or 1) it means that <strong>no ecological routines will be initiated by this species during the period of each day that it is inactive.</strong></p>
<p>This means that an inactive species <strong>will not feed, move, reproduce and will not breathe</strong>, if respiration is included in the model. This also means that even if species physically overlap and have diet connections, but a predator is not active at that time of the day, no feeding interaction will occur.</p>
<p>An inactive group is succeptible to fishing and predation.</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<p><strong>Spawning</strong></p>
<p>Species that are in the spawning period will not feed if the parameter feed_while_spawn is set to 0. The biomass of the spawning stock will subtracted when calculating the feeding biomass of a predator.</p>
<p><strong>Starvation</strong></p>
<p>Starvation has no effect on <em>C</em> and <em>mum</em> in the modified Holling functional responses (predcase 1-3) and ratio dependent feeding responses (predcase 4).</p>
<p>For other feeding responses handling time (ht_XXX in biomass pools and hta_XXX and htb_XXX in age-structured groups) is scaled by KHTD or KHTI scalars when the condition of an age structured group falls below a limit set in Kthresh1 and Kthresh2 (see box below). See chapter 10.5.2 for further details on how starvation is determined and what it affects.</p>
<p><strong>Acidification</strong></p>
<p>Atlantis includes explicit representation of the possible effects of acidification. The model is activated with the flagmodelPH=1 in the <em>biology.prm</em> file. It allows the user to scale prey availability, assimilation efficiency, <em>C</em> and <em>mum</em> rates, mortality, recruitment and other processes. See chapter 13 for further details.</p>
</section>
<section id="other-feeding-functional-responses" class="level3">
<h3 class="anchored" data-anchor-id="other-feeding-functional-responses"><em>10.2.11 Other feeding functional responses</em></h3>
<p>Twelve different feeding functional responses are currently implemented in Atlantis. They are selected using the predcase_XXX parameter, which can take values from 0 to 12 (option 3, Ecosim based feeding rate, is currently unavailable). The first three cases are for the modified Holling Type I-III responses adopted from the PPBIM. They use the <em>mum</em> parameter, as described above. Two responses – minimum-maximum and Holling size dependent type III - are adopted from the ERSEM model (see Table 18), but have not been used in many models. The remaining responses can be grouped into standard Holling responses (Holling type I to IV) and ratio depdenent responses (see e.g.&nbsp;Arditi and Ginzburg 1989 and critique of the approach by Abrams 1994). The ratio dependent responses take into account not only the prey biomass but also the ratio of prey to predator biomass. These responses don’t use the <em>mum</em> parameter but a mass specific handling time (ht_XXX) parameter.</p>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong><em>Search volume (vl) and handling time (ht) as alternative parameters to C and mum</em></strong></p>
<p>The modified Holling type functional responses use age-specific <em>C</em> and <em>mum</em> parameters. For other functional responses either one or both of these parameters are replaced with search volume (vl_XXX, vla_XXX and vlb_XXX) and handling time (ht_XXX, hta_XXX and htb_XXX).</p>
<p>Unlike <em>C</em> and <em>mum</em>, however, the search volume and handling time parameters are always set <strong>based on mass specific structural ash-free dry weight</strong> (not nitrogen!). This means that only one value is provided in the parameter file, and the age specific values for age-structured groups are calculated based on the individual’s body weight. For biomass pools the units of vl_XXX are in m<sup>3</sup> mgN<sup>-1</sup> day<sup>-1</sup>. For age structured groups vla_XXX and vlb_XXX determine an allometric search volume-mass relationship, and they are converted to individual nitrogen-based values in <em>Determine_Fish_Feeding_Prms()</em> in <strong>atvertprocesses.c</strong> where</p>
<p><img src="media/image39.wmf" class="img-fluid"> |</p>
<p>where SN is the structural nitrogen of an age class and XCN is the C:N Redfield ratio (X_CN in the biology.prm) typically set to 5.7 used to convert nitrogen mass to total ash-free dry mass.</p>
<p>For demersal species (flagdem=1) the search volume VL is halved (VL=VL/2).</p>
<p>The handling time HT is calculated as</p>
<p><img src="media/image40.wmf" class="img-fluid"> |</p>
<p>where δ<sub>starve</sub> is a scalar that reduces the handling time when an individual is starving (see chapter 10.5.2 on the effects of starvation).</p>
<p><strong>Note, that only SN and not total nitrogen values are used for search volume and handling time calculations.</strong></p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<p>The table below gives equations for the 12 functional feeding response options. In all the equations B denotes the predator’s biomass, B*<sub>prey</sub> is the available biomass of a given prey, scaled by the optional habitat refuge, and obligatory size and availability parameters, as explained above (note that prey list also includes the available fisheries catch, if the predator is identified as catch-eater in the <em>functional_groups.csv</em> file)</p>
<p><span class="math display">\[B_{prey}^{*} = p_{prey,CX} \bullet \delta_{overlap} \bullet \delta_{habitat} \bullet \delta_{size} \bullet B_{prey}\]</span></p>
<p>and <em>∑B<sub>prey,i</sub></em> is the sum of all available prey.</p>
<table class="caption-top table">
<caption><span id="_Toc526762770" class="anchor"></span>Table 18. Equations defining grazing term in the twelve currently available feeding functional responses. Some of these responses are described and compared in Fulton et al.&nbsp;2003a “Mortality and predation in ecosystem models: is it important how these are expressed?” <em>Ecological Modelling</em> 169,157–178</caption>
<colgroup>
<col style="width: 3%">
<col style="width: 53%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th>Pred case</th>
<th>Functional response</th>
<th>Equations</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>Modified Holling type II, adopted from PPBIM</td>
<td><img src="media/image41.wmf" class="img-fluid"> |</td>
</tr>
<tr class="even">
<td>1</td>
<td><p>Modified Holling type I, adopted from PPBIM</p>
<p>This response has linear increase with prey density, but is capped at the maximum determined by maximum growth rate (<em>mum</em>) divided by the assimilation efficiency on live prey (which is typically highest)</p></td>
<td><p>if (<em>C·B*<sub>prey</sub></em>) &gt; (<em>mum</em> / E<sub>preyLIVE</sub>)</p>
<p><img src="media/image42.wmf" class="img-fluid"> |</p>
<p>else</p>
<p><img src="media/image43.wmf" class="img-fluid"> |</p></td>
</tr>
<tr class="odd">
<td>2</td>
<td><p>Modified Holling type III, adopted from PPBIM</p>
<p>Same as Holling type II, but prey biomasses are squared</p></td>
<td><img src="media/image44.wmf" class="img-fluid"> |</td>
</tr>
<tr class="even">
<td>4</td>
<td><p>Minimum-maximum</p>
<p>Adopted from ERSEM, where it was used to describe fish feeding. However, it is not used in ERSEM anymore, because higher trophic level predators are not currently included in ERSEM</p></td>
<td><p><img src="media/image45.wmf" class="img-fluid"> |</p>
<p><em>L</em> = lower prey biomass threshold for feeding by predator XX (KL_XX)</p>
<p><em>U</em>= half saturation coefficient for feeding by predator XX(KU_XX)</p></td>
</tr>
<tr class="odd">
<td>5</td>
<td><p>Holling type III – size dependent</p>
<p>Adopted from ERSEM, where it was used to describe seabird and mammal feeding (it is not used in ERSEM anymore, see above)</p></td>
<td><p><img src="media/image46.wmf" class="img-fluid"> |</p>
<p>VL and HT are search volume and handling time (see above). ∑B <sub>prey.i</sub> is the sum of all available prey.</p>
<p>Remember that for demersal species (flagdem=1), the search volume is halved</p></td>
</tr>
<tr class="even">
<td>6</td>
<td><p>Ratio dependent</p>
<p>See Arditi and Ginzburg 1989 and text above. This approach accounts for competition among predators through ratio of predator and prey biomasses</p></td>
<td><p><img src="media/image47.wmf" class="img-fluid"> |</p>
<p><em>Compet</em> = interpredator competition. Please check the wiki for further details as this part of the code is changing based on discussion with experts in the field.</p></td>
</tr>
<tr class="odd">
<td>7</td>
<td><p>Standard Holling Type I</p>
<p>These are the standard Holling type responses. They have been added to Atlantis in 2015</p></td>
<td><img src="media/image48.wmf" class="img-fluid"> |</td>
</tr>
<tr class="even">
<td>8</td>
<td><p>Standard Holling Type II</p>
<p>These are the standard Holling type responses. They have been added to Atlantis in 2015</p></td>
<td><img src="media/image49.wmf" class="img-fluid"> |</td>
</tr>
<tr class="odd">
<td>9</td>
<td><p>Standard Holling Type III</p>
<p>These are the standard Holling type responses. They have been added to Atlantis in 2015</p></td>
<td><p><img src="media/image50.wmf" class="img-fluid"> |</p>
<p>As in Holling Type II but the prey and total prey biomasses are squared</p></td>
</tr>
<tr class="even">
<td>10</td>
<td><p>Standard Holling Type IV</p>
<p>These are the standard Holling type responses. They have been added to Atlantis in 2015</p></td>
<td><p><img src="media/image51.wmf" class="img-fluid"> |</p>
<p>As in Holling Type II but the total prey biomasses are squared</p></td>
</tr>
<tr class="odd">
<td>11</td>
<td><p>Hassel Varley</p>
<p>This response allows for interference among predators</p></td>
<td><p><img src="media/image52.wmf" class="img-fluid"> |</p>
<p><em>TP</em> = total predator biomass or abundance</p>
<p><em>HVM</em> = is the coefficient of mutual interference for the top carnivores</p></td>
</tr>
<tr class="even">
<td>12</td>
<td><p>Crowley Martin</p>
<p>Like Standard Holling type II but includes competition among predators as in option 6</p></td>
<td><p><img src="media/image53.wmf" class="img-fluid"> |</p>
<p><em>Compet</em> = interpredator competition. Please check the wiki for further details as this part of the code is changing based on discussion with experts in the field.</p></td>
</tr>
</tbody>
</table>
<p>Earlier when type I response was used it was important to cap the clearance rate of the predator, to ensure it does not get unrealistically high. This was done by setting flag_satiation=1. This approach caps the clearance rate at the value of <em>mum</em>/E<sub>typeLIVE</sub> , where E<sub>typeLIVE</sub> is the assimilation efficiency on live prey, which is typically the highest assimilation efficiency.</p>
<p><span class="math display">\[Gr_{prey} = \ \frac{B \bullet mum \bullet B_{prey}^{*}}{E_{typeLIVE}},\ if\ \ \ \ \ clearance &gt; \ \frac{B \bullet mum}{E_{typeLIVE}}\]</span></p>
<p>The flag_satiation parameter is a special case and in most cases will not be required.</p>
</section>
</section>
<section id="food-assimilation-in-consumers" class="level2">
<h2 class="anchored" data-anchor-id="food-assimilation-in-consumers"><strong>10.3. Food assimilation in consumers</strong></h2>
<p>The total consumed food ∑ <em>Gr<sub>prey</sub></em> is assimilated according to the consumer assimilation efficiencies of four different types of prey <em>i</em>, defined as animals (including fisheries catch), plant, labile detritus and refractory detritus. The assimilation efficiency can be further externally scaled by a scalar <em>gs</em> supplied through forcing files and used to modify growth due to factors not included in the model.</p>
<p>In consumer biomass pools (CP) all assimilated food is directly allocated to growth.</p>
<p><span class="math inline">\(G_{CP} = A_{CP} = \ \sum_{i}^{}{\left( E_{i} \bullet Gr_{prey} \right) \bullet gs}\)</span></p>
<p>In age-structured consumers (CX) the assimilated food is allocated to a temporary pool <em>A</em> (called <em>*growth</em> in Atlantis code). The energy in the pool A is used to meet optional respiration costs and the remainder then allocated to growth of SN and RN pools. Hence the <em>A</em> pool is not tracked but only used for computational purposes.</p>
<p><span class="math inline">\(A_{CX} = \ \sum_{i}^{}{\left( E_{i} \bullet Gr_{prey} \right) \bullet gs}\)</span></p>
<p>Assimilation rate in age structured groups can be affected by temperature, salinity and pH (see chapter 13).</p>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong>Accounting for maintenance costs through assimilation efficiency</strong></p>
<p>The assimilation parameter is required for both biomass pools and age-structured groups. However, depending on whether respiration costs are explicitly included in age-structured groups, the assimilation efficiency coefficient can take a different meaning.</p>
<p>In Atlantis explicit mass-specific respiration is only available in age-structured groups, where size of an average individual in an age group is tracked. For biomass pools maintenance costs are assumed to be represented implicitly in assimilation (in)efficiency. Such representation assumes that temperature responses of assimilation efficiency and maintenance processes are the same. It also assumes that when assimilation (<em>Acx</em>) is zero (no food is available) then also respiration or maintenance is zero.</p>
<p>This has important implications for obtaining assimilation efficiency values and comparing them to other models that include maintenance explicitly. For example, in ERSEM model respiration includes two components, basal respiration that is dependent on temperature and independent of the food intake, and activity respiration that represents a fraction of the assimilated food. In Atlantis basal respiration is optional and is only included for age-structured groups. The activity respiration is not explicitly modelled but is implicitly included in the assimilation efficiency.</p>
<p>If respiration of age structured groups is explicitly included in the model (see below), the assimilation efficiency of age structured groups and biomass are not directly comparable and the values for biomass pools should be much lower than that for age-structured groups.</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</section>
<section id="maintenance-respiration-in-consumers" class="level2">
<h2 class="anchored" data-anchor-id="maintenance-respiration-in-consumers"><strong>10.4. Maintenance (respiration) in consumers</strong></h2>
<p>In Atlantis the only explicit maintenance costs are those of respiration. Respiration is only included in fully age structured groups and is optional. The majority of existing Atlantis models do not explicitly model maintenance or respiration. The respiration or maintenance costs are assumed to be implicitly accounted for by assimilation inefficiencies (see NOTE! in chapter 10.3).</p>
<p>Age-structured group respiration is carried out by the <em>Fish_Respiration()</em> routine in <strong>atvertprocesses.c</strong></p>
<p>Explicit respiration in the age-structured groups represents base respiration costs and depends on body mass, temperature and condition. It is activated by setting flagresp to 1. The nitrogen used up in respiration is taken out of the temporary <em>A</em> pool (before that pool is allocated to growth) and added to the NH pool.</p>
<p>The nitrogen consumed for respiration is calculated as</p>
<p><span class="math display">\[Rs = \ e^{\left( Ktmp \bullet T_{H2O} \right)} \bullet KA \bullet {Wgt}^{KB}\]</span></p>
<p>where <em>Ktmp</em> (Ktmp_fish, Ktmp_shark, etc), <em>KA</em> (KA_XXX) and <em>KB</em> (KB_XXX) are parameters defined for each age structured group or larger functional groups (fish, sharks, mammals, birds) and <em>Wgt</em> is individual dry weight calculated as</p>
<p><em>Wgt = (SN+RN) · C_XN</em></p>
<p>The C_XN parameter represents N:C Redfield ratio, typically set to 5.7. This means that <strong><em>KA</em> and <em>KB</em> parameters relate to total dry weight</strong> of an individual and <strong>not to the nitrogen</strong> content tracked in the model.</p>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong>Should models include explicit respiration?</strong></p>
<p>Of course, all organisms have maintenance costs and they have to breathe. The question is whether including these costs implicitly in assimilation efficiencies provides sufficient representation of the physiological-ecological dynamics.</p>
<p>The key difference in using explicit respiration is that it depends on body mass, temperature and condition and is independent of the food intake rate. It is therefore more accurately reflects scaling of respiration to body size and to temperature and allows for different temperature scaling of assimilation and respiration rates.</p>
<p>If a large proportion of the biomass of the total model is in age-structured groups with strong variation in size or environmental conditions, then explicit use of respiration (flagresp=1) is a sensible option to take. However, if there is little variation in the environment, size at age or the model is dominated by biomass pool groups then setting flagres =0 may provide sufficient representation of the system. Also, when the focus of a model is to explore temperature sensitivities or growth and size dynamics of age-structured groups, then including explicit respiration may be advisable.</p>
<p>One of the reasons that Atlantis was developed in place of the earlier IGBEM and ERSEM models is because the explicit physiological detail included in those models was unwieldy to use and calibrate in each new location (imagine that a model harder than Atlantis to use!!). Therefore a simpler representation that produce approximately the same dynamics was developed and implemented in Atlantis (see for example Fulton et al.&nbsp;2004c). Explicit maintenance costs are excluded from many models, and their best representation remains a topic of debate (e.g.&nbsp;Persson et al.&nbsp;2014).</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<section id="scaling-of-respiration-costs-depending-on-individuals-condition" class="level3">
<h3 class="anchored" data-anchor-id="scaling-of-respiration-costs-depending-on-individuals-condition"><strong><em>10.4.1 Scaling of respiration costs depending on individual’s condition</em></strong></h3>
<p>Respiration costs are scaled by a factor KST in starving individuals (see chapter 10.5.2. for further details on starvation).</p>
<p>The optimum RN to SN ratio is defined by a general X_RS parameter, which is typically set to 2.65. If the RN/SN is below the optimum, the respiration costs are scaled by a factor KST. The Kthresh2 parameter controls how far below the optimum RN/SN the individual can be before the scaling of respiration costs starts.</p>
<p><span class="math display">\[if\ \frac{RN}{X_{RS}} \bullet SN &lt; Kthresh2,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \]</span></p>
<p><span class="math display">\[\ Rs = Rs \bullet KST\ \]</span></p>
<table class="caption-top table">
<caption><span id="_Toc526762771" class="anchor"></span>Table 19. Parameters defining respiration rates in age structured groups</caption>
<colgroup>
<col style="width: 26%">
<col style="width: 72%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Parameter</strong></th>
<th style="text-align: left;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">flagresp</td>
<td style="text-align: left;">Flag turning-on explicit respiration in age structured groups</td>
</tr>
<tr class="even">
<td style="text-align: left;">KA_XXX</td>
<td style="text-align: left;">Scaling coefficient of allometric respiration- weight rate</td>
</tr>
<tr class="odd">
<td style="text-align: left;">KB_xxx</td>
<td style="text-align: left;">Exponent of allometric respiration-weight rate</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ktmp_fish, Ktmp_shark, Ktmp_bird, Ktmp_mammal</td>
<td style="text-align: left;">Parameter defining how respiration increases with temperature in the four group types FISH (and FISH_INVERT), SHARK, BIRD and MAMMAL</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kthresh2</td>
<td style="text-align: left;">Threshold relative reserve below which respiration rate is scaled by KST</td>
</tr>
<tr class="even">
<td style="text-align: left;">KST_fish, KST _shark, KST _bird, KST _mammal</td>
<td style="text-align: left;">Scalar of respiration when relative reserve drops below Kthresh2 for the four group types FISH (and FISH_INVERT), SHARK, BIRD and MAMMAL</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="growth" class="level2">
<h2 class="anchored" data-anchor-id="growth"><strong>10.5. Growth</strong></h2>
<section id="growth-and-energy-allocation-in-age-structured-groups" class="level3">
<h3 class="anchored" data-anchor-id="growth-and-energy-allocation-in-age-structured-groups"><strong><em>10.5.1. Growth and energy allocation in age-structured groups</em></strong></h3>
<p>Once the optional respiration costs (<em>Rs</em>) are subtracted from the temporary pool <em>A</em>, <strong>ALL remaining</strong> energy is allocated to RN and SN. The energy is partitioned between RN and SN depending on:</p>
<ol type="1">
<li><p>the consumer’s condition, defined by the current ratio of the RN and SN pool and the X_RS parameter that sets the optimal ratio of RN to SN in well fed age structured groups</p></li>
<li><p>the consumer’s preference for rebuilding of reserves over structure, defined by the pR_XXX parameter (where higher values show lower preference for allocating to RN).</p></li>
</ol>
<p>The proportion of energy in consumer CX going to RN and SN is allocated as:</p>
<p><span class="math display">\[G_{RN} = \ (A - Rs) \bullet (1 - \lambda)\]</span></p>
<p><span class="math display">\[G_{SN} = \ (A - Rs) \bullet \lambda\]</span></p>
<p>where</p>
<p><span class="math display">\[\lambda = \ \left\{ \begin{array}{r}
\frac{\frac{1}{X\_ RS} + pR \bullet \left( \frac{RN}{pR \bullet SN} - 1 \right)}{\frac{1}{X\_ RS} + \frac{RN}{pR \bullet SN}},\ if\ (A - Rs) &gt; 0 \\
0,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ otherwise\
\end{array} \right.\ \]</span></p>
<p>The equation above shows that if respiration costs are higher than assimilated energy at a given time step (Rs&gt;A), then λ=0 and no energy will be allocated to or taken out of SN. Moreover, (A-Rs) will be negative and the difference between A and Rs is taken out of RN.</p>
<p>Traditionally in Atlantis negative (A-Rs) was not taken out of the RN and in fact most models do not include maintenance, so (A-Rs) never gets negative. To enable negative (A-Rs) to be taken out from RN pool, set the flag_shrinkfat=1. This is <strong>strongly recommended for model that use respiration</strong>. If flag_shrinkfat=0 (for legacy issues) the negative (A-Rs) is converted to zero and nothing is taken out from either RN or SN. This means that the only way RN pool can decrease is through spawning, as it is not used to cover maintenance costs during starvation.</p>
<p>Figure 15 shows the value of λ (y axis) depending on the RN/SN. Until the RN/SN is close to the X_RS value, all available energy will go to rebuilding reserves (λ=0). Black and blue lines show energy allocation under two different X_RS parameters. Once RN/SN &gt; X_RS, the condition of the animal is considered to be good and some energy is allocated to growth of SN. Once RN is replenished, all available energy will be directed to SN. The steepness of the curve and value of RN/SN above which all energy will be sent to SN depends on the pR_XXX parameter, where <strong>larger pR values lead to steeper curve and earlier allocation of all energy to SN</strong>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="media/image54.png" style="width:4.84861in;height:3.44306in" class="figure-img"></p>
<figcaption><span id="_Toc526762795" class="anchor"></span>Figure 15. Proportion of available energy allocated to SN, depending on the individual’s condition (RN/SN, on x axis), and pR and X_RS parameters.</figcaption>
</figure>
</div>
<p><strong>Black</strong>: X_RS=2.65, pR=3.5</p>
<p><strong>Red</strong>: X_RS=2.65, pR=5</p>
<p><strong>Orange</strong>: X_RS=2.65, pR=10</p>
<p><strong>Blue</strong>: X_RS=2, pR=3.5</p>
<p>Another option to consider when thinking about the representation of size in Atlantis is flag_dynamicXRS. This flag indicates whether to use a dynamically changing ratio between reserve and structural mass through time in Atlantis or to simply use a fixed value (as in the standard Atlantis code). This has implications for everything to do with size – how the optimal weight of in individual is calculated, which influences reproductive capacity and allocation of material during growth. These additions are used most commonly when dealing with evolution in Atlantis.</p>
</section>
<section id="when-is-an-age-structured-group-starving-and-what-does-it-mean" class="level3">
<h3 class="anchored" data-anchor-id="when-is-an-age-structured-group-starving-and-what-does-it-mean"><em>10.5.2. When is an age-structured group starving and what does it mean?</em></h3>
<p>Condition of an age-structured group is determined by the optimal RN to SN ratio, defined by the X_RS parameter, which is typically set to 2.65. When RN &lt; X_RS*SN the age structured group is considered to be starving (or at least food deprived).</p>
<p>This interpretation is different from some other models (e.g.&nbsp;Dynamic Energy Budget approach), where even a small amount of reserve available means that an individual has reserves and is in good condition. In Atlantis RN is not treated as pure reserve, but also includes gonad weight, fat and other body parts that can be reabsorbed during starvation.</p>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p>If respiration is not included, the only way RN pool can decrease is through spawning. This means that a group will always have lower than optimum RN/SN ratio after a spawning event, until RN pool is replenished (even when abundant food is available). If no food is available, the RN/SN ratio will not decrease further, because no maintenance costs are required.</p>
<p>If respiration is included and flag_shrinkfat = 1 then RN pool will decrease at low food abundance and an age group will be “starving” as it is usually understood.</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<p>There are different levels of starvation and they have increasing effects on ecological processes:</p>
<p><em>1) When RN/X_RS*SN &lt; 1</em></p>
<p>- the amount of spawn produced by an individual is reduced (see Spawn in Chapter 10.8).</p>
<p><em>2) When RN / X_RS*SN &lt; Kthresh1</em></p>
<p>- handling time is scaled by the KHTD parameter value. This is only applied if predcaseXXX &gt; 4</p>
<p><em>3) When RN / X_RS*SN &lt; Kthresh2</em></p>
<p>- handling time is scaled by the KHTI parameter value. This is only applied if predcaseXXX &gt; 4</p>
<p>- respiration rate is scaled by the KST parameter. This is only used if flagresp = 1 (respiration used)</p>
<p>Additionally, starvation will lead to starvation mortality, as specified by the starvation mortality parameter, see Chapter 10.6.2</p>
</section>
<section id="growth-in-consumer-biomass-pools" class="level3">
<h3 class="anchored" data-anchor-id="growth-in-consumer-biomass-pools"><strong><em>10.5.3 Growth in consumer biomass pools</em></strong></h3>
<p>No explicit respiration costs are included in biomass pools, hence all assimilated energy <em>A<sub>CP</sub></em> is allocated to growth. However, in epibenthic organisms space limitation scalar <em>δ<sub>space</sub></em> is applied to limit growth in crowded conditions</p>
<p><span class="math display">\[G_{CP} = \ A_{CP} \bullet \delta_{space}\]</span></p>
<p>The <em>δ<sub>space</sub></em> scalar is calculated differently in different invertebrate GroupTypes, and is determined by habitat dependency and/or the flagXXXlim parameter.</p>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong>Different meaning of flagXXXlim and space limitation in different invertebrate groups</strong></p>
<p>Space limitation is controlled by flagXXXlim and is applied differently for different types of invertebrates:</p>
<p><strong>For filter feeding and mobile epibenthic</strong> <strong>invertebrates</strong> (<strong>SED_EP_FF</strong> and <strong>MOB_EP_OTHER</strong>) flagXXXlim space limitation will be either simple (flagXXXlim=1) or ERSEM based (flagXXXlim=2) – called through <em>Epibenthic_Invert_Processes()</em>routine</p>
<p>If flagXXXlim=0 there is no space limitation</p>
<p>If flagXXXlim=1 space limitation is calculated as δ<sub>space</sub> scalar and applied <strong>to the biomass</strong>.</p>
<p>If flagXXXlim=2 space limitation is calculated as Crowding effect and applied to <strong>clearance rate</strong> (C)</p>
<p>For <strong>infaunal</strong> and other <strong>sediment invertebrates and primary producers</strong> (<strong>SM_INF, LG_ING</strong>, <strong>SED_EP_OTHER, CORAL and SPONGE</strong>) flagXXXlim means either no limitation (flagXXXlim=0) or simple limitation (flagXXXlim=1) – called through <em>Invertebrate_Consumer_Process()</em>, <em>Sediment_Epi_Other_Process()</em> or <em>Coral_Process()</em>routines</p>
<p>If flagXXXlim=0 no space limitation is applied</p>
<p>If flagXXXlim=1 space limitation is calculated as δ<sub>space</sub> scalar and applied <strong>to the biomass</strong>.</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<p>The space limitation scalar δ<sub>space</sub> is calculated as</p>
<p><span class="math display">\[\delta_{space} = \ \frac{1 - B_{CP}}{Max_{CP} \bullet habitat}\]</span></p>
<p>where <em>Max<sub>CP</sub></em> is the XXXmax parameter defining maximum biomass mgN m<sup>-2</sup> and <em>habitat</em> is the proportion of habitat suitable for the consumer (area of the habitat available for the species while accounting for its optional degradation). The <em>B<sub>CP</sub></em> is the consumer biomass (mgN per m<sup>2</sup>).</p>
<p>The Crowding effect is applied when flagXXXlim=2. It is based on ERSEM II model (Blackford 1997) and requires three extra parameters (XXX_low, XXX_sat, XXXthresh). The Crowing effect is <strong>applied on</strong> <strong>clearance rates and not on biomass</strong>.</p>
<p><img src="media/image55.wmf" class="img-fluid"></p>
<p>where <em>θ</em><sub>CXlow</sub> is the crowding lower threshold (XXX_low, mgN m<sup>-2</sup>), <em>κ</em><sub>CXsat</sub> is the crowding half saturation level (XXX_sat, mgN m<sup>-2</sup>), <em>κ</em><sub>CXthresh</sub> is the crowding threshold (XXXthresh, mgN m<sup>-2</sup>)</p>
<p>By default a consumer can only have intraspecific (intra functional group) competition. However, if flag_competing_epiff=1 then interspecies competition is included and <em>B<sub>CP&nbsp;</sub></em>is calculated as the total biomass of all corals (CORAL), sponges (SPONGE), epibenthic macrophytes (PHYTOBEN, SEAGRASS) and filter feeders (SED_EP_FF), which means that all epifauna will compete for space. When flag_competing_epiff=1 the user can also allow the maximum available habitat area to be higher than 1. This means that the epifaunal groups can grow on top of each other (as happens in complex reef structures). This option is set with the max_available_habitat parameter, which acts as a scalar on the available habitat. Only set this value to &gt;1 when you have good reasons to increase the habitat availability to the epifauna.</p>
<p>The δ<sub>space</sub> space limitation scalar is applied either to the biomass or to the clearance rate parameter <em>C</em> (see NOTE! box above). If more habitat limitation is needed, the <em>mum</em> values of invertebrate <strong>epibenthic and sediment</strong> biomass pool consumers (SM_INF, LG_INF, SED_EP_FF, SED_EP_OTHER, MOB_EP_OTHER) can be scaled by the available habitat. This scaling is applied by setting flag_benthos_sediment_link=1. If the scaling is applied the <em>mum</em> values of the epibenthic and sediment invertebrate biomass pool consumers will be multiplied (scaled) by the proportion of the cell with the suitable habitat (accounting for degradation effects)</p>
<p>mum*<sub>CP</sub> = mum<sub>CP</sub>·<em>habitat</em></p>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong>Habitat availability for biomass pool consumers</strong></p>
<p>Traditionally in Atlantis biomass pool consumers could only use the physically defined habitat (reef, flat, soft, canyon). These physical habitats are typically static throughout the simulation, i.e.&nbsp;their proportion in the cell does not change (unless degraded, see below).</p>
<p>This has now been modified, so that biomass pool groups can also use and be affected by the dynamic biohabitats created by functional groups identified with the IsCover parameter in the <em>functional_groups.csv</em>. Such habitats include corals, sponges, mussel beds and similar. To allow the biomass pool to access the biohabitats set flag_invert_biohab=1</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong>Degrading the geological properties</strong></p>
<p>The physical habitats are typically static throughout an Atlantis simulation, i.e.&nbsp;their proportion in the cell does not change. However, in some circumstances change is desired (e.g.&nbsp;representing a scenario of coastal development or dredging etc). In this case set flagdegrade to 1 and provide values for REEFchange_max_num, FLATchange_max_num and SOFTchange_max_num. Additionally the following parameters will be needed</p>
<p>REEFchange_start N where N is the number of changes given by REEFchange_max_num</p>
<p>d1 d2…. dN where d1, d2, dN etc represent the day of the run where a change begins</p>
<p>REEFchange_period N where N is the number of changes given by REEFchange_max_num</p>
<p>p1 p2…. pN where p1, p2, pN etc represent the period in days that a change lasts</p>
<p>REEFchange_mult N where N is the number of changes given by REEFchange_max_num</p>
<p>m1 m2…. mN where m1, m2, mN etc are the multiplicative level of change</p>
<p>Similarly for SOFT and FLAT.</p>
<p><strong>Note, users must ensure that when multipliers are applied to habitat cover, the total cell cover of geological habitats must still sum to 1.</strong> Otherwise, the suitable area in the cell will shrink or expand. So if a REEF habitat is degraded and, for example, a multiplier of 0.5 is applied, other habitats must have multipliers &gt;1 to compensate for the change.</p>
<p>Lastly the boxes where the change will occur will need to be identified (with the same change applied in all these boxes simultaneously)</p>
<p>Box_degraded N where N is the number of boxes in the model domain</p>
<p>0 0 0 0 1…. 0</p>
<p>where there are N entries, one for each box with 1 indicating changes occur in that box.</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="feeding-on-material-outside-the-model" class="level3">
<h3 class="anchored" data-anchor-id="feeding-on-material-outside-the-model"><strong><em>10.5.4 Feeding on material outside the model</em></strong></h3>
<p>During the first few months inside the model domain, salmon will stay close to shore and feed on terrestrial insects. To allow for this external input of food into salmon diet take the following steps</p>
<ol type="1">
<li><p>Set isSupplemented to a value greater than 0 in <em>functional_groups.csv</em>. A value of 1 means all life history stages will consume the supplemental feed, a value of 2 is juveniles only and a value of 3 is adults only.</p></li>
<li><p>Add a vector to the <em>biology.prm</em> file to indicate the degree of supplemental feeding occurring per box. The individual values in this vector must have values between 0 and 1 (as the value indicates for that box how much of the potential supplemental feed is actually accessed). Note the vector does not need to sum to 1.0, just that each individual value in it must be &lt; 1.0. For example, for group XXX in a 5 box model it would look like:</p></li>
</ol>
<p>Supp_XXX 5</p>
<p>0.0 0.1 0.0 0.0 0.8</p>
<p>At present this proportional access is assumed to match across all ages undertaking supplemental feeding. If this is not the case contact the Atlantis model developers for an update to the code. Also note that supplemental feeding only occurs in surface waters.</p>
<table class="caption-top table">
<caption><span id="_Toc526762772" class="anchor"></span>Table 20. Parameters affecting growth in consumers</caption>
<colgroup>
<col style="width: 8%">
<col style="width: 91%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Parameter</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>X_RS</td>
<td>Optimal RN to SN ratio in age-structured groups</td>
</tr>
<tr class="even">
<td>pR_XXX</td>
<td>Parameter controlling preference of energy allocation to RN and SN (Fig. 15)</td>
</tr>
<tr class="odd">
<td>flag_shrinkfat</td>
<td>If set to 1, negative energy budget at a given time step (when respiration costs exceed assimilated food intake) will be taken out of the RN pool. This is important for models that include respiration. If set to 0, negative energy budget is converted to 0.</td>
</tr>
<tr class="even">
<td>flaghomog_sp</td>
<td>If set to 1, body condition of age-structured groups is homogenised across the entire model domain after each timestep. This means that RN and SN ratio will be the same for a functional group throughout the whole model domain. If set to 0, condition can vary among boxes depending on food availability</td>
</tr>
<tr class="odd">
<td>flagXXXlim</td>
<td>Flag defining what kind of space limitation should be applied to biomass pool consumers or benthic primary producers (see NOTE! in chapter 10.5.3)</td>
</tr>
<tr class="even">
<td>XXXmax</td>
<td>maximum biomass of a biomass pool consumer (mgN m<sup>-2</sup>), used in simple space limitation (flagXXXlim=1)</td>
</tr>
<tr class="odd">
<td><p>XXX_low</p>
<p>XXX_sat</p>
<p>XXXthresh</p></td>
<td>Lower crowing threshold, crowding half saturation and crowding threshold (all in mgN m<sup>-2</sup>) used to calculate crowding effect in ERSEM based space limitation (flagXXXlim=2)</td>
</tr>
<tr class="even">
<td>flag_competing_epiff</td>
<td>If set to 1, space competition will be calculated taking into account all epifaunal groups (all epifaunal groups are assumed to compete for space) rather than only intra-functional competition</td>
</tr>
<tr class="odd">
<td>max_available_habitat</td>
<td>Scalar for maximum available habitat for epifaunal groups. If &gt; 1 epifaunal groups can grow on top of each other</td>
</tr>
<tr class="even">
<td>flag_benthos_sediment_link</td>
<td>Flag activating additional space limitation scaling in epibenthic and sediment biomass pool consumers, where <em>mum</em> values are scaled by the available habitat in the cell</td>
</tr>
<tr class="odd">
<td>flag_invert_biohab</td>
<td>Flag allowing biomass pool consumers to access biohabitats, identified through IsCover parameter in the <em>functional_groups.csv</em> (e.g.&nbsp;corals, sponges, mussel beds).</td>
</tr>
<tr class="even">
<td>flagdegrade</td>
<td>Flag initiating geological habitat (REEF, FLAT, SOFT) degradation. If set to 1, additional parameters will be required as explained in chapter 10.5.3</td>
</tr>
<tr class="odd">
<td>Supp_XXX</td>
<td>Proportion of a groups diet coming from outside the model domain (defined as a vector with one entry per box). On needed if isSupplemented is set to 1 in the <em>runs.prm</em> file.</td>
</tr>
</tbody>
</table>
</section>
<section id="effect-of-contaminants-on-the-growth-model" class="level3">
<h3 class="anchored" data-anchor-id="effect-of-contaminants-on-the-growth-model"><strong><em>10.5.5 Effect of contaminants on the growth model</em></strong></h3>
<p>A contaminant tracer(s) is traced through the food web to allow for assessment of the accumulation of contaminants in the food chain. The handling and introduction of these contaminants follows the standard Atlantis contaminant procedures. The level of accumulated contaminants in the individual can impact its growth using the following logistic curve to set the scalar to be applied to the growth rate (mum_XXX), this again follows the same general form as for the turbidity effects:</p>
<p><span class="math inline">\(f(x) = \ 1 - \frac{L}{1 + e^{- a(x - b)}}\)</span></p>
<p>A value must be provided per functional group per contaminant for L, a and b. In addition, the flag flag_contamGrowthModel must be set in <em>run.prm</em> to indicate how to apply the impact of contaminant on growth – 0 = no effect, 1 = InVitro method (using a simple scalar), 2 = logistic effects model. At present the contaminant may be “metabolized” by setting the decay terms in the standard Atlantis represent.</p>
<p>Growth effects due to contamination can also be represented using a simple scalar – set flag_contamGrowthModel to 1 and then for each species and each contaminant provide the following parameters in the <em>biology.prm</em> file.</p>
<p># The tissue contaminant level where growth effects start</p>
<p>XXX_Arsenic_GrowthThresh 10</p>
<p># The size of the growth effect (as a scalar)</p>
<p>XXX_Arsenic_GrowthEffect 0.9</p>
<p><em>Contaminant Uptake</em></p>
<p>The groups within Atlantis take up contaminants either through contact, general uptake or through consumption.</p>
<p>For each group the contaminant option needs to be set. There are currently two options for uptake:</p>
<ol type="1">
<li>Linear uptake (parameter is in parts/sec):</li>
</ol>
<p><span class="math display">\[C_{uptake} = \tau \bullet C\]</span></p>
<p>where <em>τ</em> is the uptake rate and C is the ambient contaminant level in the environment.</p>
<ol start="2" type="1">
<li>Sigmoidal uptake – this is ideal for representing interactions with a toxin that has no effect until a critical concentration is reached</li>
</ol>
<p><span class="math inline">\(C_{uptake} = \frac{1}{dt} \bullet \left( \frac{C}{C_{in} + \left( C - C_{in} \right) \bullet e^{- \tau \bullet dt}} - C_{in} \right)\)</span></p>
<p>where <em>C<sub>in</sub></em> is the contaminant level within the functional group (i.e.&nbsp;internal level).</p>
<p>The following parameters need to be added to the <em>biology.prm</em> file for each contaminant (where CCCC is the name of the contaminant:</p>
<p>CCC_half_life - Half life in seconds</p>
<p>CCC_temp_depend - Flag indicating whether the contaminant effect is temperature dependent</p>
<p>If there is more than one contaminant in the model, then interactions between them should be noted. Functional group level parameters are also required per contaminant included (see Table below).</p>
<p>Contaminants can also affect movement. There is the potential for mobile species (defined by the <em>VerticallyMigrates</em> and <em>HorizontallyMigrates</em> settings for the species in the <em>functional_groups.csv</em> file) to avoid the contaminants. It is not always appropriate biomass pool groups to show this behaviour so to turn it off set biopools_dodge_contam 0 in the <em>biology.prm</em>.</p>
<table class="caption-top table">
<caption><span id="_Toc526762773" class="anchor"></span>Table 21. Parameters needed for contaminant uptake model – where XXX is the functional group code and CCC the contaminant name.</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Parameter</strong></th>
<th style="text-align: left;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">XXX_CCC_uptake_option</td>
<td style="text-align: left;">Uptake option. 1 = linear, 2 = sigmoidal, 3 = piecewise linear</td>
</tr>
<tr class="even">
<td style="text-align: left;">XXX_CCC_uptake_rate</td>
<td style="text-align: left;">Uptake rate in mg/m^3 per second</td>
</tr>
<tr class="odd">
<td style="text-align: left;">XXX_CCC_ InstantDoseMortality</td>
<td style="text-align: left;">Instantaneous contact mortality rate</td>
</tr>
<tr class="even">
<td style="text-align: left;">XXX_CCC_TimeToLD50</td>
<td style="text-align: left;">The number of seconds that it takes to kill of 50% of the population</td>
</tr>
<tr class="odd">
<td style="text-align: left;">XXX_CCC_LD50</td>
<td style="text-align: left;">The concentration that will kill 50% of the population</td>
</tr>
<tr class="even">
<td style="text-align: left;">XXX_CCC_LD100</td>
<td style="text-align: left;">The concentration that will kill 100% of the population</td>
</tr>
<tr class="odd">
<td style="text-align: left;">XXX_CCC_LDChronic</td>
<td style="text-align: left;">The concentration where chronic effects persist</td>
</tr>
<tr class="even">
<td style="text-align: left;">XXX_CCC_LDslope</td>
<td style="text-align: left;">Slope of the internal LDC relationship</td>
</tr>
<tr class="odd">
<td style="text-align: left;">XXX_CCC_Cx</td>
<td style="text-align: left;">First constant used in piecewise interpolation of mortality effects across multiple contaminants</td>
</tr>
<tr class="even">
<td style="text-align: left;">XXX_CCC_Cy</td>
<td style="text-align: left;">Second constant used in piecewise interpolation of mortality effects across multiple contaminants</td>
</tr>
<tr class="odd">
<td style="text-align: left;">XXX_CCC_spL</td>
<td style="text-align: left;">The minimum of the growth effects curve if the logistic effects curve is used</td>
</tr>
<tr class="even">
<td style="text-align: left;">XXX_CCC_spA</td>
<td style="text-align: left;">The curve of the growth effects curve if the logistic effects curve is used</td>
</tr>
<tr class="odd">
<td style="text-align: left;">XXX_CCC_spB</td>
<td style="text-align: left;">The midpoint of the growth effects curve if the logistic effects curve is used</td>
</tr>
<tr class="even">
<td style="text-align: left;">XXX_CCC_ GrowthThresh</td>
<td style="text-align: left;">The tissue contaminant level at which growth effects manifest if using the InVitro growth effects model</td>
</tr>
<tr class="odd">
<td style="text-align: left;">XXX_CCC_EC50</td>
<td style="text-align: left;">Exponent used in the InVitro growth effects model for primary producers and microfauna</td>
</tr>
<tr class="even">
<td style="text-align: left;">XXX_CCC_ECslope</td>
<td style="text-align: left;">Slope of the InVitro growth effects model for primary producers and microfauna</td>
</tr>
<tr class="odd">
<td style="text-align: left;">XXX_CCC_GrowthEffect</td>
<td style="text-align: left;">The size of the growth effect (as a scalar) on consumers if using the InVitro growth effects model</td>
</tr>
<tr class="even">
<td style="text-align: left;">XXX_CCC_MoveEffect</td>
<td style="text-align: left;">Effect on movement (as a scalar)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">XXX_CCC_ReprodEffect</td>
<td style="text-align: left;">Effect on reproduction (as a scalar)</td>
</tr>
<tr class="even">
<td style="text-align: left;">XXX_CCC_sp_ContamScalar</td>
<td style="text-align: left;">The scalar used to represent the generic effects of contaminants on other physiological parameters</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="mortality-in-consumers" class="level2">
<h2 class="anchored" data-anchor-id="mortality-in-consumers"><strong>10.6. Mortality in consumers</strong></h2>
<p>Mortality for age-structured groups is modelled through the numbers of individuals lost, whereas for biomass-pools it is expressed as biomass lost. The general non-predation and non-fishing mortality equation is:</p>
<p><span class="math display">\[M_{xx} = \ \left( \left( mL + mQ \bullet xx + mSt + \left( 1 - \delta_{O2} \right) \bullet mO + mA + mE \right) \bullet xx \right) \bullet mortsc\]</span></p>
<p>where <em>mL</em> is linear mortality (day<sup>-1</sup>), <em>mQ</em> is quadratic mortality (day<sup>-1</sup>), <em>mSt</em><strong><sub>,</sub></strong> is <strong>age-structured group only</strong> starvation mortality (day<sup>-1</sup>), <em>mO</em> is <strong>benthic invertebrate only</strong> low oxygen mortality (day<sup>-1</sup>), δ<sub>O2</sub> is the oxygen limitation scalar (see below), <em>mA</em> is an optional acidification mortality (day<sup>-1</sup>), <em>mE</em> is the optional extra mortality of <strong>age-structured groups only</strong> (due to seabirds and fish not included in the model) (day<sup>-1</sup>), <em>xx</em> is the biomass or numbers in the biomass pool or age group and <em>mortsc</em> is the optional external mortality scalar, provided through forcing files (see details <a href="https://confluence.csiro.au/pages/viewpage.action?spaceKey=Atlantis&amp;title=External+Mortality%2C+Growth+and+Recruitment+Scaling">here</a>). Below these mortality terms are discussed for age-structured and biomass pool groups separately.</p>
<p>Note that the oxygen mortality is assumed to only apply to benthic invertebrates as they cannot easily escape the oxygen minima, whereas fish and other vertebrates will move away (ultimately disappearing from the model if the entire domain becomes too oxygen poor and if the group is dependent on the oxygen – flagO2depend).</p>
<section id="mortality-in-age-structured-groups" class="level3">
<h3 class="anchored" data-anchor-id="mortality-in-age-structured-groups"><strong><em>10.6.1. Mortality in age-structured groups</em></strong></h3>
<p>The natural non-predation mortality of an age-structured consumer CX (in numbers not biomass) is calculated for each age group as:</p>
<p><span class="math display">\[M_{CX} = \ \left( \left( mL + mQ \bullet Num_{CX} + mSt + mA + mE \right) \bullet Num_{CX} \right) \bullet mortsc\]</span></p>
<p>where <em>mL</em> is an stage-specific (juvenile and adult) linear mortality for CX (mL_XXX, day<sup>-1</sup>), <em>mQ</em> is an stage-specific quadratic mortality for CX (mQ_XXX, day<sup>-1</sup>), <em>mSt</em> is the starvation mortality (day<sup>-1</sup>, see below), <em>mA</em> is an optional acidification mortality (see below), <em>mS</em> is the optional extra mortality due to seabirds and fish not included in the model (adopted from ERSEM I, Bryant <em>et al</em>. 1995) (mS_XXX, day<sup>-1</sup>), <em>Num</em> is the numbers in an age group and <em>mortsc</em> is the optional external mortality scalar, provided through forcing files. See chapter on the forcing file for details on extra mortality scaling.</p>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong>Terminal or senescence mortality in age structured groups and age structured biomass pools</strong></p>
<p>At the end of the lifespan the individuals (biomass) can either all die (senesce) or remain in the last cohort (“plus group” in stock assessment jargon) for as long as they survive predation or other mortality factors. The senescence mortality is activated by the parameter flagsenesce.</p>
<p>If flagsenesce=1 all individuals above the maximum age die. The maximum age is set as the number of calendar years in an age group (XXX_AgeClassSize) multiplied by the number of age groups (NumCohorts). If flagsenesce=0 the oldest calendar year group in the oldest age group retains all the individuals (see chapter 10.9.6 on tracking calendar years in age groups).</p>
<p>Terminal mortality (mT) behaves somewhat similarly for biomass pools – indicating what proportion of the oldest age class dies due to old age.</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<p>The mortality calculations are done in <em>Vert_Mortality()</em> routine in <strong>atvertprocesses.c</strong></p>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong>Role of linear and quadratic mortality in multi-species models</strong></p>
<p>Linear and quadratic mortality terms are included to account for mortality factors not explicitly represented in the model – such as disease, behaviour-based density dependence (e.g.&nbsp;male rivalry), predators not explicitly represented in the model and other factors. Ideally, the linear mortality terms should be as low as possible (1-e15) or even zero across the board, while quadratic mortality should be low (or zero) for lower trophic levels and of moderate size for the largest of the top predators (where unrepresented density dependent factors appear to be missing from the model as formulated).</p>
<p>If high linear and quadratic mortality values are used, the model will be insensitive to species interactions. High linear and quadratic mortalities mean that the species will be controlled by these terms alone and predation will have little to no effect on the group’s biomass. As a result, the ecosystem model will end up being a set of parallel simulations of many single species models.</p>
<p>The exception is for top predators, such as mammals or seabirds, where predation mortality alone is typically too low to impose adequate control. In these cases, higher terms of quadratic mortalities are often applied. There is a good argument that for mammals and birds competition for breeding sites, disease and other factors indeed may be the main processes controlling population growth, and they should be represented via the quadratic mortality term.</p>
<p>Rates of linear and quadratic mortality are provided for juveniles and adults separately in age-structured groups. The age groups that belong to the juvenile versus adult stage are determined based on the XXX_age_mat parameter in the <em>biology.prm</em> file, which sets the first mature (adult) age group.</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</section>
<section id="starvation-mortality-in-age-structured-groups" class="level3">
<h3 class="anchored" data-anchor-id="starvation-mortality-in-age-structured-groups"><strong><em>10.6.2. Starvation mortality in age-structured groups</em></strong></h3>
<p>Starvation mortality is only available in age-structured groups, as the condition (ration of SN to RN) is tracked for these groups only. Starvation mortality is modelled as</p>
<p><span class="math display">\[mSt = mStarve \bullet \frac{(Kthreshm \bullet optCond - W)}{optCond}\]</span></p>
<p>where <em>optCond</em> =(1.0 + X_RS)·SN, <em>W</em> is weight calculated as SN+RN, <em>mStarve</em> (mStarve_XXX, day<sup>-1</sup>) is starvation mortality rate, Kthreshm is a global (same for all species) parameter defining the threshold undernourishment levels when starvation mortality starts and X_RS is a global parameter that sets the optimum RN to SN ratio (typically set to 2.65).</p>
<p><strong>Note</strong>, that weight (W) used here is the <strong>nitrogen weight</strong>, defined as SN+RN and is different from weight used in respiration (where AFDW is used and calculated as N multiplied by the nitrogen to carbon Redfield ratio X_CN).</p>
<p>The calculations for starvation mortality are done in the <em>Vert_Mortality()</em> routine in <strong><u>atvertprocesses.c</u></strong></p>
<p><img src="media/image56.png" style="width:4.31111in;height:3.46181in"></p>
<p><span id="_Toc526762796" class="anchor"></span>Figure 16. Starvation mortality (per day) for different Kthreshm and mStarve values.</p>
<p><strong>Black</strong>: Kthrem=0.9, mStarve=0.001</p>
<p><strong>Orange</strong>: Kthrem=0.8, mStarve=0.001</p>
<p><strong>Red</strong>: Kthrem=0.7, mStarve=0.001</p>
<p><strong>LightBlue</strong>: Kthrem=0.9, mStarve=0.0005</p>
<p><strong>Blue</strong>: Kthrem=0.9, mStarve=0.01</p>
</section>
<section id="extra-mortality-in-age-structured-groups" class="level3">
<h3 class="anchored" data-anchor-id="extra-mortality-in-age-structured-groups"><strong><em>10.6.3. Extra mortality in age-structured groups</em></strong></h3>
<p>The <strong>optional</strong> extra mortality <em>mS</em> allows users to simulate <strong>quarterly</strong> <strong>age structured group</strong> mortality by seabirds and fish (or other top predators) <strong>not included</strong> in the model. It is given by mS_SBXXX (seabird imposed mortality on age structured group XXX) and mS_FDXXX (fish imposed mortality on age structured group XXX) parameters, each with four values, providing mortality for each quarter of the year.</p>
<p>Additional parameters describe the assimilation efficiency of these top predators not included in the model; the unassimilated food is all added to the ammonia pool (see chapter 10.7 for further details)</p>
<p>Note that the extra mortality is rarely used now, because models typically resolve all important functional groups explicitly in the model. As a result this form of mortality will likely be removed in future code releases.</p>
</section>
<section id="mortality-in-biomass-pool-consumers" class="level3">
<h3 class="anchored" data-anchor-id="mortality-in-biomass-pool-consumers"><strong><em>10.6.4. Mortality in biomass pool consumers</em></strong></h3>
<p>Non-predation mortality in consumers is expressed in term of the biomass lost to the biomass pool, where separate calculations are done for each pool in age-structured biomass pools.</p>
<p><span class="math display">\[M_{CP} = \ \left( \left( mL + mQ \bullet B_{CP} + \left( 1 - \delta_{O2} \right) \bullet mO + mA \right) \bullet B_{CP} \right) \bullet mortsc\]</span></p>
<p>Only one linear (<em>mL</em>) and quadratic (<em>mQ</em>) mortality parameter is provided for biomass pool groups, whereas for age-structured biomass pools separate parameters are needed for each pool. The oxygen mortality depends on the oxygen limitation scalar and the oxygen mortality rate (mO_XXX; day<sup>-1</sup>). The oxygen limitation mortality is determined by the <em>δ<sub>O2</sub></em> oxygen scalar, described in chapter 10.2.8.</p>
<p>As in age-structured groups, the age-structured biomass pools can have senescence mortality (see chapter 10.6.1).</p>
</section>
<section id="temperature-and-acidification-effect-on-mortality" class="level3">
<h3 class="anchored" data-anchor-id="temperature-and-acidification-effect-on-mortality"><strong><em>10.6.5. Temperature and acidification effect on mortality</em></strong></h3>
<p>Linear and quadratic mortality parameters can be temperature dependent, as described in chapter 13. If a model includes acidification effects (flagmodelpH=1) then parameters imposing additional acidification induced mortality can be specified.</p>
</section>
<section id="turbidity-effect-on-mortality" class="level3">
<h3 class="anchored" data-anchor-id="turbidity-effect-on-mortality"><strong><em>10.6.6. Turbidity effect on mortality</em></strong></h3>
<p>A logistic curve is applied to represent the escapement from predation due to turbidity:</p>
<p><span class="math inline">\(f(x) = \ 1 - \frac{L}{1 + e^{- a(x - b)}}\)</span></p>
<p>The value of the escapement is a proportion (i.e.&nbsp;between 0 and 1). At present this escapement only modifies the availability of the prey to its predator during feeding, it does not alter the prey’s habitat dependent movement (i.e.&nbsp;the prey species move to their preferred habitat and ignore any turbidity effects, if you want prey to take turbidity into account as cover so that it modifies their movement please let us know and we will update the code).</p>
<p>To activate this effect (i) flagIsEstuary must be set to 1 in the <em>run.prm</em> file so that the SED_i tracer is active in the model – it will need to be included in the <em>initial_conditions.nc</em> file and can also be included in point source inputs (.ts files) to represent any material coming down the rivers into the model domain. The flag turbid_refuge_XXX for each species – set it to 1 if the prey benefits from turbidity, 0 if not. Then for each predator you need to enter the following three vectors, which include one value for each stage of the functional group (as defined by NumStages in the <em>functional_groups.csv</em> file):</p>
<p>XXX _turbid_L which defines the minimum of the curve (per stage)</p>
<p>XXX _turbid_a which defines the slope of the curve (per stage)</p>
<p>XXX _turbid_b which defines the midpoint of the curve (per stage)</p>
<p>These vectors have the format like:</p>
<p>XXX _turbid_L 2</p>
<p>1.0 0.8</p>
<table class="caption-top table">
<caption><span id="_Toc526762774" class="anchor"></span>Table 22. Parameters affecting mortality in consumers</caption>
<colgroup>
<col style="width: 11%">
<col style="width: 87%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Parameter</strong></th>
<th style="text-align: left;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mL_XXX</td>
<td style="text-align: left;">Stage-specific (juvenile and adult) linear mortality, day<sup>-1</sup></td>
</tr>
<tr class="even">
<td style="text-align: left;">mQ_XXX</td>
<td style="text-align: left;">Stage-specific (juvenile and adult) quadratic mortality, day<sup>-1</sup></td>
</tr>
<tr class="odd">
<td style="text-align: left;">mS_XXX</td>
<td style="text-align: left;">Optional extra mortality due to seabirds and fish not included in the model, day<sup>-1</sup></td>
</tr>
<tr class="even">
<td style="text-align: left;">flagsenesce</td>
<td style="text-align: left;">If set to 1, all individuals or biomass in age-structured groups and age-structured biomass pools that are above the maximum age die (see NOTE! in chapter 10.6.1)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mT</td>
<td style="text-align: left;">Terminal senescence mortality in age-structured biomass pools (proportion of biomass that dies from senescence when above maximum age)</td>
</tr>
<tr class="even">
<td style="text-align: left;">mStarve_XXX</td>
<td style="text-align: left;">Starvation mortality, day<sup>-1</sup></td>
</tr>
<tr class="odd">
<td style="text-align: left;">mS_SBXXX</td>
<td style="text-align: left;">Extra mortality of age-structured groups due to seabirds not included in the model, day<sup>-1</sup></td>
</tr>
<tr class="even">
<td style="text-align: left;">mS_FDXXX</td>
<td style="text-align: left;">Extra mortality of age-structured groups due to fish not included in the model, day<sup>-1</sup></td>
</tr>
<tr class="odd">
<td style="text-align: left;">mO_XXX</td>
<td style="text-align: left;">Oxygen mortality rate of biomass pool consumers, day<sup>-1</sup></td>
</tr>
<tr class="even">
<td style="text-align: left;">Kthreshm</td>
<td style="text-align: left;">Threshold starvation level, when starvation mortality starts (chapter 10.6.2)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">turbid_refuge_XXX</td>
<td style="text-align: left;">Flag indicating whether a group has its mortality effected by turbidity</td>
</tr>
<tr class="even">
<td style="text-align: left;">XXX _turbid_L</td>
<td style="text-align: left;">defines the minimum of the turbidity effect on mortality curve (per stage)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">XXX _turbid_a</td>
<td style="text-align: left;">defines the slope of the turbidity effect on mortality curve (per stage)</td>
</tr>
<tr class="even">
<td style="text-align: left;">XXX _turbid_b</td>
<td style="text-align: left;">defines the midpoint of the turbidity effect on mortality curve (per stage)</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="waste-production" class="level2">
<h2 class="anchored" data-anchor-id="waste-production"><strong>10.7. Waste production</strong></h2>
<p>The unassimilated food (faeces) and non-predation mortality products are sent to labile detritus (DL), refractory detritus (DR) and ammonia (NH) pools. The production of waste products by biomass pool and age structured group consumers are handled in the same way, but in the case of age structured groups the mortality terms are converted from numbers of individuals to biomass before being used in the following equations.</p>
<p>Flow of nitrogen from food intake to detritus and the ammonia pool can be illustrated with the flowchart in Fig. 17. It shows that first, the assimilation efficiency parameters determine how much of the grazed food is assimilated. The rest is sent to waste products. The waste products are then split between detritus and the ammonia fraction, where the amount of detritus is determined by the detritus proportion parameters (FDG, FDGDL, FDGDR).</p>
<p><img src="media/image57.jpg" style="width:5.79281in;height:6.26042in"></p>
<p><span id="_Toc526762797" class="anchor"></span>Figure 17. Nitrogen flow from consumers to detrital and ammonia pools. Parameters that determine allocation between the pools are shown on the arrows. Optional fluxes are shown in dashed arrows.</p>
<p>Production of <strong>labile detritus (DL)</strong> by consumer group XX is given by:</p>
<p><span class="math display">\[W_{DL} = \ \left( \left( 1 - E_{L} \right) \bullet FDG \bullet \sum_{i = type}^{}{Gr_{CX,i} + \left( 1 - E_{DL} \right) \bullet FDGDL \bullet Gr_{CX,DL} + \left( 1 - E_{DR} \right)} \bullet FDGDR \bullet Gr_{CX,DR} + FDM \bullet M_{CX} \right) \bullet FDL\]</span></p>
<p>where E<sub>L</sub> is the assimilation efficiency on live prey (E_XXX) and plants (EPlant_XXX), <em>Gr<sub>CX,i</sub></em> is the amount of different live prey types consumed, E<sub>DL</sub> assimilation efficiency on labile detritus (EDL_XXX) and E<sub>DR</sub> assimilation efficiency on refractory detritus (EDR_XXX), FDG is the proportion of the unassimilated prey (animal, plant and catch grazing) that is sent to detritus (FDG_XXX), FDGDR is proportion of unassimilated refractory detritus that is sent to detritus (FDGDR_XXX), FDGDL is proportion of unassimilated labile detritus that is sent to detritus (FDGDL_XXX), and FDM is the proportion of mortality products assigned to detritus (FDM_XXX). FDL determines the allocation of detritus between labile and refractory pools and is defined not by species but by four types of groups: fish and sharks (FDL_fish), birds and mammals (FDL_top), water column biomass pools except CEP and PWN (FDL_wc), other non-vertebrate biomass pools (FDL_benth – note that this includes CEP and PWN not just the true benthic invertebrate groups).</p>
<p>Production of <strong>refractory detritus (DR)</strong> uses the same equation, except that:</p>
<ol type="1">
<li><p>the final multiplication is done not by the FDL parameter but by (1-FDL)</p></li>
<li><p>detritus produced from <strong>all</strong> unassimilated food consumed by optional seabirds and fish NOT explicitly represented in the model is added to DR (see Fig 17 and below)</p></li>
</ol>
<p><span class="math display">\[W_{DR} = \ \left( \left( 1 - E_{L} \right) \bullet FDG \bullet \sum_{i = type}^{}{Gr_{CX,i} + \left( 1 - E_{DL} \right) \bullet FDGDL \bullet Gr_{CX,DL} + \left( 1 - E_{DR} \right)} \bullet FDGDR \bullet Gr_{CX,DR} + FDM \bullet M_{CX} \right) \bullet (1 - FDL) + FFSB \bullet M_{S}\]</span></p>
<p>Here <em>M<sub>S</sub></em> represents the optional extra age structured group mortality by predators NOT included in the model (modelled through the mS_XXX parameter), and FFSB is the assimilation <strong>inefficiency</strong> of these age structured groups. The assimilation inefficiency of <strong>seabirds NOT</strong> included in the model is specific for each age structured group consumed and is set in parameters FSBDR_XXX where XXX is the age-structured group eaten. The assimilation inefficiency of <strong>fish NOT</strong> included in the model is same for all prey species and is set in parameter FFDDR.</p>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong>Assimilation (in)efficiency of predators included and not included in the model</strong></p>
<p>For <strong>predators included in the model</strong> (normal grazing term) assimilation efficiencies E (E, EPlant, EDL and EDR parameters) show the <strong>proportion of assimilated food</strong>. Fraction of unassimilated food then equals (1-E).</p>
<p>For optional <strong>predators NOT included in the model</strong> (represented through extra age structured group mortality terms mS) assimilation parameters FSBDR and FFDDR show the <strong>proportion of unassimilated food</strong>. This proportion of the optional extra mortality term is sent to the refractory detritus pool and the remaining fraction is <strong>taken out of the model</strong>.</p>
<p>It only makes sense to include non-zero parameters for FSBDR_XXX and FFDDR when extra mortality due to seabirds and fish NOT included in the model is represented through mS_SBXXX and mS_FDXXX arrays.</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<p>The remaining fraction of the mortality products (1-FDM) and unassimilated food (1-FDG, 1-FDGDL and 1-FDGDR) and nitrogen used up in respiration is sent to the <strong>ammonia pool</strong>.</p>
<table class="caption-top table">
<caption><span id="_Toc526762775" class="anchor"></span>Table 23. Parameters determining waste production processes</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 92%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Parameter</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>E_XXX</p>
<p>EPlant_XXX</p>
<p>EDR_XXX</p>
<p>EDL_XXX</p></td>
<td>Assimilation efficiency of consumer XXX when feeding on: animal prey (and catch), plant prey, refractory detritus and labile detritus</td>
</tr>
<tr class="even">
<td>FDG_XXX</td>
<td>Proportion of unassimilated animal and plant food (faeces) by consumer XXX that becomes detritus</td>
</tr>
<tr class="odd">
<td>FDGDL_XXX</td>
<td>Proportion of unassimilated labile detrital food (faeces) by consumer XXX that becomes detritus</td>
</tr>
<tr class="even">
<td>FDGDR_XXX</td>
<td>Proportion of unassimilated refractory detrital food (faeces) by consumer XXX that becomes detritus</td>
</tr>
<tr class="odd">
<td>FDM_XXX</td>
<td>Proportion of mortality products of group XXX that is assigned to detritus</td>
</tr>
<tr class="even">
<td><p>FDL_fish</p>
<p>FDL_top</p>
<p>FDL_wc</p>
<p>FDL_benth</p></td>
<td>Proportion of labile detritus of all detritus produced by each of the four groups: fish and sharks (fish), birds and mammals (top), water column biomass pools except CEP and PWN (wc) and other non-vertebrate biomass pools including CEP and PWN (benth)</td>
</tr>
<tr class="odd">
<td>FSBDR_XXX</td>
<td>Assimilation inefficiency of seabirds not included in the model that feed on a functional group XXX. This proportion is sent to refractory detritus pool</td>
</tr>
<tr class="even">
<td>FFDDR</td>
<td>Assimilation inefficiency of fish not included in the model (same for all functional groups preyed upon). This proportion is sent to refractory detritus pool</td>
</tr>
</tbody>
</table>
</section>
<section id="spawn" class="level2">
<h2 class="anchored" data-anchor-id="spawn"><strong>10.8. Spawn</strong></h2>
<p>Spawning and recruitment is only explicitly modelled in age structured groups and age-structured biomass pools. They are handled by multiple routines in the <strong>atdemography.c</strong> file. In simple biomass pools reproduction is implicitly included in the growth term.</p>
<section id="sexual-maturation-in-age-structured-groups" class="level3">
<h3 class="anchored" data-anchor-id="sexual-maturation-in-age-structured-groups"><em>10.8.1. Sexual maturation in age-structured groups</em></h3>
<p>Maturation in age-structured groups is determined by two parameters. First, a fraction of each age class that is sexually mature is set in the FSPB_XXX parameter (ogive), with an option for gradual external change in this parameter through forcing files. Second, an optional minimum length (where the allometric length/weight conversion parameters li_a_XXX and li_b_XXX are used to get length) required for sexual maturation is set in min_li_mat_XXX. If this parameter is &gt; 0 then the no maturation will occur in an age class if it is below the maturation length even if FSPB parameter for that age class is &gt; 0.</p>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong>Juveniles, adults (life history stages) and sexual maturation (or spawning contributions)</strong></p>
<p>Atlantis does not assume that the age of sexual maturation aligns with the ontogenetic shift in the use of habitats and prey. Sexual maturation (or the contribution to spawning in any one year by members of each age class) is given by the spawning ogive FSPB_XXX or the min_li_mat_XXX maturation length.</p>
<p>In contrast the age at which individuals switch from juvenile behaviour (in terms of feeding, habitat use, prey) to adult behaviour is given by XXX_age_mat. This is the first age group where adult behaviour is expressed and is modelled as a hard transition point with all individuals switching to adult behaviour at once.</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</section>
<section id="spawning-in-age-structured-groups" class="level3">
<h3 class="anchored" data-anchor-id="spawning-in-age-structured-groups"><strong><em>10.8.2. Spawning in age-structured groups</em></strong></h3>
<p>The number of times an age-structured group spawn per year is given by NumSpawns in the <em>functional_groups.csv</em> file, although it is typically 1 (more frequent spawning is new functionality so let us know if you are having issues with it). When spawning occurs all spawn is produced in one time step. The day of the year that a species XXX spawns is set by the parameter XXX_Time_Spawn (if more than one spawning event occurs per year a vector of values is required). Although there is a parameter called XXX_spawn_period in the <em>biology.prm</em> file, it does not control the spawn period, but is just used to calculate recruitment delays (see below).</p>
<p>For each age group the amount of actual spawn produced is determined according to the condition of individuals in the age group at the time of spawning. The optimum spawning weight (<em>Wsp</em><sub>i</sub>) of an age group <em>i</em> is calculated as</p>
<p><span class="math display">\[Wsp_{i} = (1 + XRS) \bullet SN_{i}\]</span></p>
<p>where X_RS is a parameter defining the optimum ratio of RN to SN in well fed age structured groups (typically set to 2.65) and <em>SN<sub>i</sub></em> is SN of an age group <em>i</em></p>
<p>The amount of spawn (<em>Sp</em>, mgN) produced by an age group is calculated as</p>
<p><span class="math display">\[Sp = \left( \left( W_{sp} \bullet FSP - KSPA \right) - \left( W_{sp} - W \right) \right) \bullet Num \bullet FSPB\]</span></p>
<p>where (W<sub>sp</sub> –W) is the weight difference between the optimal weight for spawn and the actual nitrogen based weight of an individual (W=SN+RN), <em>FSP</em> is the proportion of weight-for-spawn used for spawn (FSP_XXX; typically ranging between 0.25 to 0.42), <em>KSPA</em> is a constant used by the spawning formulation (KSPA_XXX), <em>Nm</em> is the number of individuals in an age group, and <em>FSBP</em> is the proportion of mature reproducing individuals in the age group (FSPB_XXX). For those groups where not every adult reproduces ever year this value should be set &lt;1 even for fully mature age classes. Note, that if individual’s weight is smaller than the ideal weight at given age (defined by X_RS ratio), then the amount of spawn produced is decreased by the weight deficit (W<sub>sp</sub> –W) is subtracted from the spawn that would be produced in case of ideal weight.</p>
<p>The <em>KSPA</em> accounts for costs of reproduction or the amount of N taken out of weight but not included in the produced spawn. It is tuned during the parameterisation, and represents the base investment needed to build gonads and other reproductive materials. It is not however cohort specific, so the same cost is applied to each cohort.</p>
<p>Vertebrate spawn is calculated by the <em>Ecology_Age_Structured_Spawn()</em> routine in <strong>atdemography.c</strong>. This routine is called from two other routines: <em>Ecology_Do_Internal_Age_Structured_Spawning()</em> and <em>Ecology_Do_External_Age_Structured_Spawning()</em>, both in <strong>atdemography.c</strong>. The latter two routines convert individual spawn to spawn produced by a species in the model (or individuals that migrated outside the model domain), summing spawn over age groups to get the total spawn produced by the group.</p>
</section>
<section id="maturation-and-spawn-in-age-structured-biomass-pools" class="level3">
<h3 class="anchored" data-anchor-id="maturation-and-spawn-in-age-structured-biomass-pools"><strong><em>10.8.3. Maturation and spawn in age-structured biomass pools</em></strong></h3>
<p>In age-structured biomass pools the proportion of mature biomass in an age pool is set by the FSPB_XXX parameter. The amount of spawn (mgN) produced by an age biomass pool <em>i</em> is then calculated as</p>
<p><span class="math display">\[Sp_{i} = B_{i} \bullet FSP \bullet FSPB_{i}\]</span></p>
<p>where <em>B<sub>i</sub></em> is the biomass of the age pool (mgN), FSPB is the proportion of the mature biomass in the pool <em>i</em> (FSBP_XXX), and FSP is the proportion of spawning biomass in the mature biomass (FSP_XXX)</p>
<p><strong>The amount of nitrogen taken from the biomass pool after spawning is not necessarily equal to the spawn produced (Sp), but is set by the parameter prop_spawn_lost_XXX.</strong> This lost biomass represents semelparous reproduction and is used to represent the mortality of exhausted adults or can be set = 1 for full semelparity (all individuals die after reproduction, as in some squid species). The lost biomass is treated as normal mortality and sent to DL, DR and NH3 pools.</p>
<p>Reproduction of age structured biomass pools is done in the <em>Invertebrate_Reproduction()</em> routine in <strong>atdemography.c</strong></p>
<table class="caption-top table">
<caption><span id="_Toc526762776" class="anchor"></span>Table 24. Parameters determining maturation and spawn</caption>
<colgroup>
<col style="width: 9%">
<col style="width: 89%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Parameter</strong></th>
<th style="text-align: left;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FSPB_XXX</td>
<td style="text-align: left;">A fraction of each age class in an age-structured groups and age-structured biomass pools that is sexually mature</td>
</tr>
<tr class="even">
<td style="text-align: left;">min_li_mat_XXX</td>
<td style="text-align: left;">Minimum length required for sexual maturation in age-structured groups (calculated using length-weight conversion parameters li_a_XXX and li_b_XXX)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">XXX_age_mat</td>
<td style="text-align: left;">The first age group where adult behaviour is expressed in distribution, feeding, prey availability. It is modelled as hard transition and can be different from sexual maturation defined by FSPB_XXX parameters</td>
</tr>
<tr class="even">
<td style="text-align: left;">XXX_Time_Spawn</td>
<td style="text-align: left;">Day of the year that a species XXX spawns (all spawn occurs at once)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FSP_XXX</td>
<td style="text-align: left;">Proportion of ideal weight for spawn that is used for spawn</td>
</tr>
<tr class="even">
<td style="text-align: left;">KSPA_XXX</td>
<td style="text-align: left;">Constant used by the spawning formulation, it represents reproductive costs and does not contribute to spawn</td>
</tr>
<tr class="odd">
<td style="text-align: left;">prop_spawn_lost_XXX</td>
<td style="text-align: left;">Amount of nitrogen taken from age-structured biomass pool after spawning. Used to represent both nitrogen lost to spawn and reproduction related mortality</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="recruitment-and-ageing" class="level2">
<h2 class="anchored" data-anchor-id="recruitment-and-ageing"><strong>10.9. Recruitment and ageing</strong></h2>
<p>Atlantis does not currently model the larval period explicitly. In fully age-structured groups and age-structured biomass pools nitrogen produced as spawn is temporarily taken out of the model and is returned as recruits after a set larval period. In simple (non-age structured) biomass pools reproduction is not modelled explicitly. The larval period is set as</p>
<p>XXX_larval_period = XXX_Recruit_Time + XXX_Spawn_Period + optional_small_scale_random_variation</p>
<p>After this time recruits start “arriving” into the model throughout the period set in Recruit_Period_XXX. Nineteen different recruitment options are currently available for converting the base spawn amount into the biomass and numbers of recruits. The most common function applied for fish species is the Beverton-Holt (BH) function, dependent on both spawn produced and biomass of the species. For mammals, birds and some sharks a constant recruit production per adult is often used.</p>
<p>Some of the recruitment options ignore the spawn altogether, others ignore both spawn and species biomass, others use random number generation and others allow for scaling of recruitment by plankton production. In most cases the amount of nitrogen in spawn is not equal to the amount of nitrogen in recruits. Recruitment is modelled in the same way in age-structured groups and in age-structured biomass pools, but in age-structured groups the recruited biomass is subsequently converted to numbers, using the SN and RN values of recruits provided by the user (KWSR_XXX and KWRR_XXX respectively).</p>
<p>The amount of recruits produced can be influenced by one or several of these factors, and none of them are obligatory:</p>
<ol type="1">
<li><p>amount of spawn produced</p></li>
<li><p>stock biomass</p></li>
<li><p>phytoplankton</p></li>
<li><p>zooplankton</p></li>
<li><p>external recruitment forcing</p></li>
</ol>
<p>Recruited individuals are attributed to the first year of the first age group. The day before the recruits “arrive”, all other individuals age one year up, and can be allocated into a different age group depending on the number of years in each age group. Ageing is done in one time step, regardless of whether recruits arrive all at once or during a certain period of time.</p>
<section id="routines-used-to-calculate-recruitment-in-age-structured-groups" class="level3">
<h3 class="anchored" data-anchor-id="routines-used-to-calculate-recruitment-in-age-structured-groups"><strong><em>10.9.1 Routines used to calculate recruitment in age-structured groups</em></strong></h3>
<p>Several routines in Atlantis are involved in obtaining the final number of recruits. For age-structured groups (vertebrates), the total spawn produced by a species (calculated in the routines above, in the chapter on spawning) is passed to:</p>
<ol type="1">
<li><p>The <em>Ecology_Find_Embryos()</em> routine, which applies environmental scalars, such as scaling by plankton production. It also applies external recruitment forcing, for cases where recruitment time series are supplied. In the case of Beverton-Holt or Ricker recruitment, which are dependent on the spawn or species biomass, nothing is done in this routine.</p></li>
<li><p>The value above is then passed to the <em>Get_Recruits()</em> routine which calculates the recruitment (<em>Rs</em>) depending on the chosen recruitment option.</p></li>
<li><p>Next, two routines <em><strong>–</strong> Get_Vertical_Recruit_Position()</em> and <em>Find_Final_Recruit_Distribtuion() <strong>–</strong></em>determine the horizontal and vertical distribution of new recruits, depending on the distribution parameters provided by the user, whether the group has maternal care, set as flagmotherXXX or bear live young, set as flagbearliveXXX (in which case the recruits arrive where the adults are), and any optional environmental limitations (salinity, temperature, oxygen). The flagmotherXXX parameter allows users to set semelparous reproduction, where value of &lt;0 kills reproducing (FSPB_XXX proportion) adults after reproduction.</p></li>
<li><p>Next, the routine <em>Get_Settlers()</em> distributes the recruits on the temporal scale, depending on the length recruitment period and shape of the recruitment distribution.</p></li>
<li><p>Finally, immediately before the recruits arrive, all other age groups age one year up. This is done in <em>Update_Ageing_Numbers()</em> and a few other routines in the <strong><u>atdem</u>ography.c</strong> (which track the relative proportions per annual age class per age group)</p></li>
</ol>
<p>Next we will give details on how Atlantis calculates recruitment (<em>Rs</em>) from spawn (<em>Sp</em>) for different recruitment options. Equations below combine calculations done in both <em>Ecology_Find_Embryos()</em> and <em>Get_Recruits()</em> routines.</p>
</section>
<section id="stock-recruitment-options" class="level3">
<h3 class="anchored" data-anchor-id="stock-recruitment-options"><strong><em>10.9.2. Stock-recruitment options</em></strong></h3>
<p>The most common Beverton-Holt recruitment (selected as flagrecruitXXX=3) is implemented as:</p>
<p><span class="math display">\[Rc = \ \frac{Sp \bullet BHa}{Biom + BHb}\]</span></p>
<p>where <em>BHa</em> and <em>BHb</em> are species-specific Beverton-Holt alpha and Beverton-Holt beta parameters (BHalpha_XXX and Bhbeta_XXX, mgN), <em>Sp</em> is the spawn produced (mgN, see Spawn chapter) and <em>Biom</em> is the species total biomass. Note that because this <em>Rc</em> is dealing with nitrogen and not recruits entering a fishery, the obtained values will not match those given in stock assessment models.</p>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong>Converting recruit biomass <em>Rc</em> to numbers</strong></p>
<p>The <em>Rc</em> is calculated in nitrogen biomass. For age-structured groups it is then converted to numbers using the recruit SN and RN values provided by the user as KWSR_XXX and KWRR_XXX parameters .</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<p>Other recruitment options are:</p>
<p><strong>1) Constant recruitment flagrecruitXXX=1</strong></p>
<p>Recruitment is constant through time and is independent on the stock size. The KDENR_XXX parameter in <em>biology.prm</em> file gives the number of “arriving” each year.</p>
<p><span class="math display">\[Rc = \ KDENR\]</span></p>
<p>This is a useful representation if recruitment is dictated by a large external stock not represented in the model.</p>
<p><strong>2) Recruitment determined by chlA concentration</strong> <strong>flagrecruitXXX=2</strong></p>
<p><strong>Recruitment is calculated separately in each cell</strong>. It is determined by the amount of chlA in the cell, species specific PP_XXX parameter relating recruitment to primary production and a ref_chl parameter providing the reference ChlA level (from both LG_PHY and SM_PHY)</p>
<p><span class="math display">\[Rc = PP \bullet \ \frac{chlA}{ref_{chl}}\]</span></p>
<p><strong>3) Beverton-Holt spawn and species biomass dependent recruitment flagrecruitXXX=3</strong></p>
<p>This is the most commonly applied recruitment option for fish and is described above.</p>
<p><strong>4) Random lognormal recruitment flagrecruitXXX=4</strong></p>
<p>In this option recruitment is completely random and does not depend either on the spawn produced or on the biomass of the species. The centre and variation of the lognormal distribution curve (δ<sub>lonorm</sub>), from which the recruitment is sampled, is set by the lognorm_mu and lognorm_sigma parameter respectively. Further, each species has a specific recruitment multiplier XXX_log_mult <em>(l_multiplier</em> in the equation below) converting the lognormal value, which is typically in the range from 0 to 1 (depending on lognorm_mu and lognorm_sigma values) to the actual number of recruits.</p>
<p><span class="math display">\[Rc = \ \delta_{lonorm} \bullet l_{multiplier}\]</span></p>
<p>Note, that even though Atlantis is fundamentally a deterministic model (the same results are obtained with same sets of conditions and parameters) the lognormal recruitment option would generate different results for each simulation, adding some stochasticity to Atlantis simulation outcomes.</p>
<p><strong>5)</strong> <strong>Recruitment determined by phyto- and zooplankton abundance flagrecruitXXX=5</strong></p>
<p>Recruitment is calculated similarly to the case 2, but now depends not on ChlA concentration but on the sum of the large phytoplankton and small zooplankton biomass, such that</p>
<p><em>plankton</em>=LG_PHY+LG_ZOO+MED_ZOO+SM_ZOO</p>
<p>The same two parameters PP_XXX and ref_chl used in the primary production based option are also used here to relate plankton levels to recruitment. Note that in ChlA or plankton dependent recruitment, spawn or species biomass is not taken into account. <strong>SM_PHY is not included here</strong> because it is not believed to be an important fish larvae food source.</p>
<p><span class="math display">\[Rc = PP \bullet \ \frac{plankton}{ref_{chl}}\]</span></p>
<p><strong>6)</strong> <strong>Beverton-Holt recruitment with lognormal variation and plankton dependency flagrecruitXXX=6</strong></p>
<p>This recruitment option combines options 3, 4 and 5. Recruitment depends on spawn and species biomass, as in option 3, plankton levels as in option 5, and is also modified with a lognormal scalar δ<sub>lonorm</sub> calculated based on lognorm_mu and lognorm_sigma parameters, as described in option 4.</p>
<p><span class="math display">\[Rc = \delta_{lonorm} \bullet \frac{Sp \bullet BHa}{Biom + BHb} \bullet \ \frac{plankton}{ref_{chl}}\]</span></p>
<p><strong>7)</strong> <strong>Beverton-Holt recruitment with encouraged recovery flagrecruitXXX=7</strong></p>
<p>Recruitment is calculated as in option 3, but a species-specific recruitment encouragement multiplier recover_mult_XXX is applied to <em>Rc</em> if a species biomass is below a threshold set in the recover_trigger parameter. This threshold levels shows a proportion of the initial stock biomass below which the recruitment multiplier is applied. The recruitment multiplier is applied for the number of years given in recover_subseq parameter. Moreover, the recruitment multiplier will only kick-in after a set period of days after the threshold stock proportion has been reached. This lag between low stock levels and encouraged recruitment is set in recover_span parameter. This recruitment option represents adaptive stocking or density dependent processes that only activate at low recruit levels.</p>
<p><strong>8)</strong> <strong>Beverton-Holt recruitment with prescribed recovery flagrecruitXXX=8</strong></p>
<p>Same as above, but the recruitment encouragement multiplier recover_mult_XXX is applied to <em>Rc</em> regardless of the stock levels for the period set in recover_span and recover_subseq parameters (potentially represented a period where an unknown environmental or ecological driver facilitated recruitment).</p>
<p><strong>9)</strong> <strong>Ricker recruitment flagrecruitXXX=9</strong></p>
<p>Ricker recruitment is not dependent on the spawn produced, but is based on biomass and the two parameters Ralpha_XXX and Rbeta_XXX. The <em>Rc</em> is calculated as</p>
<p><span class="math display">\[Rc = Biom \bullet e^{Ralpha \bullet \left( 1 - \frac{Biom}{Rbeta} \right)}\]</span></p>
<p>The Ricker recruitment parameter Ralpha and Rbeta are sometimes interpreted as r or intrinsic population growth and K or carrying capacity (see <a href="https://en.wikipedia.org/wiki/Ricker_model">here</a> for example)</p>
<p><strong>10) Beverton-Holt recruitment based only on species biomass flagrecruitXXX=10</strong></p>
<p>Calculated similarly to option 3, but instead of spawn (Sp), only <strong>total species</strong> biomass is used.</p>
<p><span class="math display">\[Rc = \ \frac{Biom \bullet BHa}{Biom + BHb}\]</span></p>
<p><strong>11) Recruitment is equal to spawn flagrecruitXXX=11</strong></p>
<p>This is the simplest recruitment option, where the nitrogen in recruits is simply equals the nitrogen spawned.</p>
<p><span class="math display">\[Rc = \ Sp\]</span></p>
<p><strong>12) Fixed number of offspring per individual flagrecruitXXX=12</strong></p>
<p>In this option the KDENR_XXX parameter provides the number of offspring per individual. This recruitment option is often applied for mammals, birds and viviparous sharks. When setting this option remember that Atlantis models an average individual, hence the actual number of offspring per female may need to be halved in a population of equal sex ratio or reduced if there is in utero dynamics (such as siblicide in sharks), or if mortality sources outside the model domain (e.g.&nbsp;land-based predation of turtle eggs) needs to be implicitly represented.</p>
<p>In this case, recruitment produced by an age group is calculated as</p>
<p><span class="math display">\[Rc = \ KDENR \bullet FSPB \bullet Num\]</span></p>
<p>where <em>FSPB</em> is the proportion of mature individuals in the age group (FSPB_XXX) and <em>Num</em> is the total number of individuals in the age group. Note, that for this recruitment option spawn will still be calculated and taken out of the model, but recruitment will only be determined by the number of offspring per individual multiplied by the number of spawning individuals.</p>
<p><strong>13) Recruitment forced from time series file flagrecruitXXX=13</strong></p>
<p>In this option the recruitment value Rc is taken from externally forced time series files. The name of the recruitment time series file must be provided in the <em>force.prm</em> file. In this option, spawn will still be calculated and taken out of the model, but recruitment will only be determined by external forcing.</p>
<p><strong>14) Larval recruitment –</strong> This option leaves space for explicit larval recruitment to be tracked, but it is currently not available in Atlantis.</p>
<p><strong>15) Jacknife recruitment flagrecruitXXX=15</strong></p>
<p>This option allows two levels of recruitment depending on the spawning stock biomass (SSB), calculated as the wet weight in tonnes (not nitrogen weight!) of spawning individuals and a set threshold <em>B<sub>jack</sub></em>, calculated as a fraction of total biomass:</p>
<p><span class="math display">\[B_{jack} = jack_{b} \bullet Biom\]</span></p>
<p>If SSB &lt; <em>B<sub>jack</sub></em></p>
<p><span class="math display">\[Rc = jack_{a} \bullet SSB\]</span></p>
<p>If SSB ≥ <em>B<sub>jack</sub></em></p>
<p><span class="math display">\[Rc = jack_{a} \bullet B_{jack}\]</span></p>
<p>The jack_a_XXX is interpreted as slope of recruitment, usually set as biomass of recruits / SSB. The jack_b_XXX is empirical proxy for a relationship with the carrying capacity (in the North Sea they used 0.3 * long term average total biomass). This recruitment relationship is taken from the North Sea stock assessment - see a more detailed description on the <a href="https://confluence.csiro.au/display/Atlantis/2013/04/23/Jackknife+recruitment">wiki</a></p>
<p><strong>16) Coral recruitment flagrecruitXXX=16</strong></p>
<p>Coral (and sponge) recruitment is determined by three specific coral recruitment parameters CrecruitA_XXX, CrecruitB_XXX and CrecruitC_XXX and a KDENR_XXX parameter setting a total number of recruits.</p>
<p>The recruitment is calculated as</p>
<p><span class="math display">\[Rc = KDENR + CrecA \bullet max\left( 0,\left( CrecB - e^{- CrecC \bullet B^{*}} \right) \right)\]</span></p>
<p>where B* is the spawning biomass (if corals are modelled as age-structured biomass pools the spawning biomass will be determined by the FSPB parameter).</p>
<p><strong>17) Baltic Sea version of the Ricker recruitment flagrecruitXXX=17</strong></p>
<p>The Baltic Sea version of the Ricker recruitment uses wet weight (not nitrogen based!) biomass B<sub>WW</sub> in <strong>thousands of tonnes</strong> and calculates Rc as:</p>
<p><span class="math display">\[Rc = 1000 \bullet Biom_{WW} \bullet Ralpha \bullet e^{- 1 \bullet Rbeta \bullet Biom_{WW}}\]</span></p>
<p><strong>18) Multiple time series of recruitment – specific forcing in separate boxes flagrecruitXXX=18</strong></p>
<p>This option allows forcing of recruitment from specific boxes. Numbers of recruits are forced by external forcing files and they only arrive in boxes specified in the forcing files. The horizontal and vertical distribution of these recruits is then determined according to the general rules, described in the next chapter below. See further description on Atlantis <a href="https://confluence.csiro.au/display/Atlantis/2014/05/12/Multiple+recruitment+time+series+turning+up+in+different+boxes">wiki</a>.</p>
<p><strong>19) Beverton-Holt recruitment based only on spawn only flagrecruitXXX=19</strong></p>
<p>Calculated similarly to option 3, but instead of biomass, only species spawn (<em>Sp</em>) is used.</p>
<p><span class="math display">\[Rc = \ \frac{Sp \bullet BHa}{Sp + BHb}\]</span></p>
<p>Finally, in addition to the recruitment options above, it is also possible to supplement recruits with external stocking. This is used to imitate, for example, supplementary stocking of salmon. Recruit stocking for a species XXX is set setting flagstockingXXX=1 and providing details on recruit stocking files. These files, and the code the recruit stocking triggers, are the same used to apply multiple time series of recruitment (flagrecruitXXX=18). See <a href="https://confluence.csiro.au/display/Atlantis/2015/03/24/Recruit+stocking">this</a> post on the wiki for further details.</p>
<p><strong>20)</strong> <strong>Ricker recruitment using SSB flagrecruitXXX=20</strong></p>
<p>As for option 9, but in this case SSB not total population biomass, with <em>Rc</em> calculated as</p>
<p><span class="math display">\[Rc = SBB \bullet e^{Ralpha \bullet \left( 1 - \frac{SSB}{Rbeta} \right)}\]</span></p>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong>Interspecies dependency scalar</strong></p>
<p>It is possible in Atlantis to scale recruitment by the biomass of another species Y. This could be used to simulate, for example, consumption of cod eggs by sprat in the Baltic Sea. The interspecies dependency of species XXX recruitment is set with a flag intersp_depend_recruit_XXX, where 1 means linear scaling and 2 is inverse scaling. Parameter intersp_depend_sp_XXX gives the ID number of species Y (from the functional_groups.csv file). The intersp_depend_scale_XXX is a scalar to apply to recruitment, showing the influence of the biomass of species group Y on the recruitment of XXX.</p>
<p>If recruitment of species XXX is dependent of species Y, and intersp_depend_recruit_XXX=1 recruitment Rc of XXX is calculated as</p>
<p>Rc=Rc*intersp_depend_scale*biomassY</p>
<p>If intersp_depend_recruit_XXX=2</p>
<p>Rc=Rc*intersp_depend_scale/biomassY</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong>Calculating recruitment for different stocks</strong></p>
<p>If several stocks per species are used (identified with NumStocks parameter in the functional_ group.csv file) the procedures described above calculate recruitment for each stock separately, using the biomass of that stock rather than the total species biomass. The user also has an option to use stock specific recruitment scalars recSTOCK_XXX to upscale or downscale recruitment in different stocks.</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</section>
<section id="environmental-habitat-and-external-recruitment-scalars" class="level3">
<h3 class="anchored" data-anchor-id="environmental-habitat-and-external-recruitment-scalars"><strong><em>10.9.3. Environmental, habitat and external recruitment scalars</em></strong></h3>
<p>The recruitment value <em>Rc</em> calculated above can be further modified by habitat availability, biomass of other species, environmental conditions, and additional recruit supplementing (stocking). All of these factors are optional and will be applied as multipliers on the base recruitment. Most of them affect recruitment in a negative way. When several scalars are applied (pH, temperature, contaminants), the user must be careful about the multiplicative nature of all these scalars, as they can drastically reduce recruitment.</p>
<p>The pH, temperature, salinity, contaminant and external time series scalars are calculated in <em>Get_Enviro_Recruit_Forcing()</em> routine. They use pHcorr, Tcorr and Scorr values that are applied to different physiological processes of a species and calculated in relevant pH and temperature routines (see chapter 13).</p>
<p><strong>1. pH scalar</strong></p>
<p>If a species is sensitive to pH (flagfecundsensitive_XXX=1) its recruitment will be scaled by a pH scalar, based on the pHcorr scalar calculated in the pH related routines (see below). The scalar is calculated as</p>
<p>pHscalar=1/pHcorr</p>
<p>as it assumes that pH effect on recruitment will be negative (scalar will be &lt;1)</p>
<p><strong>2. Temperature scalar</strong></p>
<p>To activate temperature dependent recruitment for any species set flagtempdepend_reprod to 1 and then set species parameters to indicate how the dependency is expressed. If a species is sensitive to temperature (flagtempsensitiveXXX) <strong>with the kind of effect dictated by the recruitment temperature dependency</strong> (flagq10receffXXX=1 or 2 – 1 for poorer when cooler, 2 if poorer when warmer, 0 indicates no actual effect regardless of flagtempsensitiveXXX setting) then recruitment is scaled by a multiplicative effect of pH and temperature (pHscalar*Tcorr). The pH effect will be 1 if a species is only sensitive to temperature and not pH. If species is temperature insensitive (flagq10receffXXX=0) only the pHscalar on recruitment is applied. If the pHscalar·Tcorr &gt; 1 then the inverse is applied to scale the recruitment (1/(pHscalar·Tcorr)) as the model assumes that effect of temperature and pH on recruitment will be negative</p>
<p>The <strong>effect of temperature</strong> on recruitment of temperature sensitive species (flagtempsensitiveXXX=1) is also simulated through minimum and maximum spawn temperatures (XXX_min_spawn_temp and XXX_max_spawn_temp). If temperature in the cell is outside these ranges, then the scalar is set to 0 and recruitment <strong>in that cell</strong> will be zero.</p>
<p><strong>3. Salinity scalar</strong></p>
<p>If a species is sensitive to salinity (flagSaltSensitive_XXX=1) the recruitment is first scaled by the Scorr scalar, and second, the models checks whether the salinity conditions in the cell are within the minimum and maximum spawn salinity ranges (XXX_min_spawn_salt and XXX_max_spawn_salt). If salinity in the cell is outside these ranges, then the scalar is set to 0 and recruitment <strong>in that cell</strong> will be zero.</p>
<p><strong>4. Contaminant scalar</strong></p>
<p>If the model tracks contaminants, then a scalar on recruitment due to contaminants is also calculated and applied.</p>
<p><strong>5. Externally forced scalar</strong></p>
<p>Users can supply external recruitment forcing scalar through time series files, listed in the <em>force.prm</em> file (see chapter 8). The external scalar will act as a multiplier on all other scalars calculated above. To indicate that external environmental recruitment forcing will be used set flagtsforcerecruit=1 in the <em>biology.prm</em> file. If this flag is set to 1, but no external forcing is provided then Atlantis will quit. This forcing represents environmental influence on recruitment (such as El Nino etc) and is called from <em>Get_Enviro_Recruit_Forcing()</em>.</p>
<p>On top of these scalars an additional external forcing can be applied to recruitment, in the same way as forcing is applied to growth, mortality or other processes. This recruitment forcing is done separately to allow further representation of external processes, such as for example contaminant spill. This final kind of <em>force.prm</em> recruitment scalar is applied within the <em>Get_Final_Distribution()</em> routine and is called from <em>Ecology_Get_Recruitment_Scalar()</em>.</p>
<p><strong>6. Habitat scalar</strong></p>
<p>Habitat scalar on recruitment acts as an additional multiplier on all environmental scalars above. It is applied if species recruitment is habitat dependent (XXX_rec_HabDepend=1). The habitat scalar is calculated as a proportion of suitable habitat in the cell.</p>
</section>
<section id="spatial-distribution-of-recruits" class="level3">
<h3 class="anchored" data-anchor-id="spatial-distribution-of-recruits"><strong><em>10.9.4. Spatial distribution of recruits</em></strong></h3>
<p>Once the recruitment biomass and/or numbers are calculated Atlantis will first define their vertical and then horizontal distribution. This is done in two routines <em>Get_Vertical_Recruit_Position()</em> and <em>Find_Final_Recruit_Distribtuion()</em>. The first routine uses the XXX_recruit_vdistrib parameters. This parameter provides entries for a maximum number of water layers so the routine rescales the vertical recruit distribution in each box depending on how many layers it has and weighs the vertical distribution towards the bottom or surface depending on whether a species is identified as demersal (flagdemXXX=1) or not.</p>
<p>Next, the routine <em>Find_Final_Recruit_Distribtuion()</em> determines the final spatial distribution of recruits.</p>
<p>If enviro_independ_larvae is set to 0 then all the scalars calculated above (including the environmental scalars) are applied to find the final recruit number for each box and layer given the vertical and horizontal distribution parameters. If enviro_independ_larvae is set to 1 then environmental scalars calculated above are not applied to the recruit_hdistrib and will only apply once the settlers (juveniles) have arrived. Also note the point in the larval period when environmental effects are calculated is set using flag_recruit_effect – set to 1 for the environmental effects to be calculated at the time the recruits settle (i.e.&nbsp;effects are on older larve or very small juveniles) or 0 if the environmental effects are to be calculated around the time of spawning (i.e.&nbsp;very young larvae effected). If any other period of time for the effect is needed contact the developers.</p>
<p>The base horizontal distribution, just like the vertical distribution is given by the user in XXX_recruit_hdistrib parameter, which simply gives proportional number of recruits allocated in each box. This potential distribution is modified based on whether the recruits actually recruit to the same location as the adults (RecruitType is set to 1 in the <em>functional_groups.csv</em> file) and whether local temperature, salinity, habitat conditions are suitable (if enviro_independ_larvae is set to 0).</p>
<p>The final number of recruits in a cell is then given as</p>
<p>Recruits_in_cell = AllRecruits · All_scalars · Vertical_distribution · Horizontal_distribution</p>
<p>It is also possible to apply an externally forced larval dispersal matrix (if RecruitType is set to 3 in the <em>functional_groups.csv</em> file) to modify the horizontal and vertical distribution of the recruits. This is described further <a href="https://confluence.csiro.au/pages/viewpage.action?spaceKey=Atlantis&amp;title=Recruitment+Options">here</a>.</p>
<p>It is possible that the sum of the final Recruits_in_cell may not sum to 1.0. If this final non-normalised value is desired set the flag norm_larval_distrib to 0 (i.e.&nbsp;to have it sum to 1.0 set the flag to 1). It may be desirable to have a non-normalised value if the desires is to capture variation in recruitment due to environmental conditions and dispersal (e.g.&nbsp;if environmental conditions are such that many cells have become unsuitable or if habitat conditions more larvae than would have normally survived under the assumed stock recruit relationship survive).</p>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong>Minimum and maximum salinity and temperature can greatly reduce recruitment</strong></p>
<p>It is important to realise that <strong>minimum and maximum spawn temperature and salinity act as scalars on recruitment in a box</strong>. Unlike the way in which settled individuals will contract away from unsuitable conditions during movement, recruit distributions <strong>do not</strong> contract to the boxes with suitable conditions but rather <strong>kill all the recruits</strong> that end up in unsuitable boxes. This means that if many boxes have conditions that are outside the suitable recruitment values the total recruitment in the model can be greatly reduced.</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</section>
<section id="factors-defining-temporal-arrival-of-recruits" class="level3">
<h3 class="anchored" data-anchor-id="factors-defining-temporal-arrival-of-recruits"><strong><em>10.9.5. Factors defining temporal arrival of recruits</em></strong></h3>
<p>Once the total number of recruits to arrive in each cell is calculated using the procedures above, their arrival is spread throughout the Recruit_Period_XXX. This is done by the <em>Get_Settlers()</em> routine. Two options are available for this, controlled with a global (applied to all species) flagtrecruitdistrib parameter. The recruit arrival can be flat, so that same number of recruits arrive every day (flagtrecruitdistrib=1) or it can be humped (lognormal) (flagtrecruitdistrib=0).</p>
<p>If a lognormal distribution is used the user should also provide rec_m and rec_sigma parameters, determining the shape of the lognormally shaped curve (the same number of recruits will arrive, but not evenly spread through time).</p>
<p>Also note that there is an additional parameter XXX_cohort_recruit_entry that identifies which cohort recruits enter in. Typically, this is zero, but for multi-year and complicated migration patterns this may be set to a value of one or more.</p>
</section>
<section id="modifying-size-at-recruitment" class="level3">
<h3 class="anchored" data-anchor-id="modifying-size-at-recruitment"><strong><em>10.9.6. Modifying size at recruitment</em></strong></h3>
<p>Representing differential survival can be done in two ways, both of which use a time series file. To activate these set flag_modify_KWSR in the <em>biology.prm</em> file to a value greater than 0.</p>
<p>In both cases KWRR will be reset so that it is KWSR * X_RS.</p>
<p>If flag_modify_KWSR is set to 1 then the model will load a time series of multipliers to apply to the constant KWSR supplied for the group in the <em>biology.prm</em> file. If flag_modify_KWSR is set to 2 then the model will load a time series file of values to use for KWSR. In both cases the file for KWSR is supplied in <em>force.prm</em> as follows</p>
<p>KWSR_forcing <em>KWSR_filename.ts</em></p>
<p>The format of the <em>KWSR_filename.ts</em> is as follows for the scalar (flag_modify_KWSR set to 1) option (shown for 1 species, if multiple species are being forced in this way add an additional column for each species)</p>
<p># Scalar for structural sizes of recruits</p>
<p>#</p>
<p>## COLUMNS 2</p>
<p>##</p>
<p>## COLUMN1.name Time</p>
<p>## COLUMN1.long_name Time</p>
<p>## COLUMN1.units days since 2000-01-01 00:00:00 +10</p>
<p>## COLUMN1.missing_value 0</p>
<p>##</p>
<p>## COLUMN2.name XXX</p>
<p>## COLUMN2.long_name XXX</p>
<p>## COLUMN2.units scalar</p>
<p>## COLUMN2.missing_value 0.0</p>
<p>1 0.8</p>
<p>2 2.0</p>
<p>If the absolute value case (flag_modify_KWSR set to 2) is being used then the file format is as follows</p>
<p># Structural sizes of recruits</p>
<p>#</p>
<p>## COLUMNS 2</p>
<p>##</p>
<p>## COLUMN1.name Time</p>
<p>## COLUMN1.long_name Time</p>
<p>## COLUMN1.units days since 2000-01-01 00:00:00 +10</p>
<p>## COLUMN1.missing_value 0</p>
<p>##</p>
<p>## COLUMN2.name XXX</p>
<p>## COLUMN2.long_name XXX</p>
<p>## COLUMN2.units mg N</p>
<p>## COLUMN2.missing_value 0.0</p>
<p>1 110.8</p>
<p>2 112.1</p>
</section>
<section id="stochastic-variation-around-mean-recruitment" class="level3">
<h3 class="anchored" data-anchor-id="stochastic-variation-around-mean-recruitment"><strong><em>10.9.7. Stochastic variation around mean recruitment</em></strong></h3>
<p>It is possible to use all of the above to set the level of recruitment and then add normally distributed random fluctuations around that value. To do this set XXX_flag_recruit_stochastic to 1 in the <em>biology.prm</em> file and then set the sigma for the normal distribution for that species group using XXX_ norm_sigma. It will use the calculated level of recruitment as the “mean” of the distribution.</p>
</section>
<section id="ageing-of-individuals" class="level3">
<h3 class="anchored" data-anchor-id="ageing-of-individuals"><strong><em>10.9.8. Ageing of individuals</em></strong></h3>
<p>As recruits “arrive” they enter the first age group of a species. For species that have more than one calendar year per age group they are entered into the first year of the first age group.</p>
<table class="caption-top">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><p><strong>NOTE!</strong></p>
<p><strong>Tracking calendar years within Atlantis age groups</strong></p>
<p>Although some species have several calendar years in one age group for the purposes of simplifying the ecological processes, for aging Atlantis actually tracks individuals of each calendar year within age group separately. This is illustrated in the left Figure 18 below where three calendar years (bars of the same colour) are tracked in each of the four age groups (AG1-AG4). The ageing routines move the individuals from one calendar year to the next (solid line arrows).</p></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<p>All individuals in one age group AG are assumed to be identical for predation, reproduction, fishing and other processes. Mortality can be proportionally allocated across annual age cohorts within an age class. However, it is also possible to dampen strong year classes during the ageing process and equalise their relative abundance. This assumes that the most abundant year classes will be more affected by predation and fishing that less abundant ones and that through time the relative abundance of year classes will even out. The figure on the right shows that the abundant youngest year class in year t becomes less abundant in year t+1, while the relative abundance of the other two year classes in that age group increases (shown with bold outlines). In the year t+1, the newly arrived year class is shown in green, and the oldest year class from age group 1 is now in the age group 2.</p>
<p><img src="media/image58.jpg" style="width:2.58333in;height:2.87639in"></p>
<p><img src="media/image59.jpeg" style="width:2.70694in;height:2.70625in"></p>
<p><span id="_Toc526762798" class="anchor"></span>Figure 18. Tracking of calendar years in Atlantis age groups. Left: three calendar years for each of the four age groups (AG1-AG4) illustrated. Right: dampening of strong year classes through time.</p>
<p>Dampening of strong year classes during ageing routines is controlled by the flagrecpeakXXX parameter used in the <em>Update_Age_Distrib()</em> routine. If flagrecpeakXXX=0 then dampening of strong year classes will use the recruitRangeFlat multiplier, and if the flagrecpeakXXX=1 then dampening of strong year classes will use the recruitRange multiplier. By setting the values for recruitRangeFlat and recruitRange the user can control how much dampening will occur. If no dampening is wanted set the values to 1.</p>
<p>The dampening effect and the related parameters described above are <strong>irrelevant for species that only have one calendar year in an age group</strong>.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>